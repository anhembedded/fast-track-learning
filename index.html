<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev Unit Test Wiki</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <i data-feather="box"></i>
                <h1>Dev Unit Test Wiki</h1>
            </div>
            <button id="theme-toggle" class="theme-toggle">
                <i data-feather="moon" class="icon-moon"></i>
                <i data-feather="sun" class="icon-sun"></i>
            </button>
        </header>

        <nav class="sidebar">
            <ul class="nav-menu">
                <li class="nav-item active" data-target="home">
                    <i data-feather="home"></i>
                    <span>Trang ch·ªß</span>
                </li>
                <li class="nav-item" data-target="getting-started">
                    <i data-feather="play-circle"></i>
                    <span>B·∫Øt ƒë·∫ßu</span>
                </li>
                <li class="nav-category">Thi·∫øt k·∫ø Test</li>
                <li class="nav-item" data-target="structuring-metrics">
                    <i data-feather="layout"></i>
                    <span>C·∫•u tr√∫c v√† Ch·ªâ s·ªë</span>
                </li>
                <li class="nav-item" data-target="london-vs-classical">
                    <i data-feather="git-pull-request"></i>
                    <span>London vs. Classical</span>
                </li>
                <li class="nav-item" data-target="test-data-patterns">
                    <i data-feather="database"></i>
                    <span>M·∫´u d·ªØ li·ªáu Test</span>
                </li>
                <li class="nav-category">Nguy√™n t·∫Øc C·ªët l√µi</li>
                <li class="nav-item" data-target="four-pillars">
                    <i data-feather="shield"></i>
                    <span>B·ªën tr·ª• c·ªôt</span>
                </li>
                <li class="nav-item" data-target="behavior-vs-implementation">
                    <i data-feather="cpu"></i>
                    <span>Behavior vs. Implementation</span>
                </li>
                <li class="nav-category">Ch·ªß ƒë·ªÅ N√¢ng cao</li>
                <li class="nav-item" data-target="test-doubles">
                    <i data-feather="copy"></i>
                    <span>Test Doubles (Mocks & Stubs)</span>
                </li>
                <li class="nav-item" data-target="architecture-mocking">
                    <i data-feather="git-branch"></i>
                    <span>Ki·∫øn tr√∫c v√† Mocking</span>
                </li>
                <li class="nav-category">Th·ª±c h√†nh (Hands-on)</li>
                <li class="nav-item" data-target="pytest-hands-on">
                    <i data-feather="terminal"></i>
                    <span>PyTest</span>
                </li>
                <li class="nav-item" data-target="gtest-hands-on">
                    <i data-feather="code"></i>
                    <span>GTest</span>
                </li>
                <li class="nav-category">T√†i nguy√™n</li>
                <li class="nav-item" data-target="glossary">
                    <i data-feather="book-open"></i>
                    <span>T·ª´ ƒëi·ªÉn thu·∫≠t ng·ªØ</span>
                </li>
            </ul>
        </nav>

        <main class="main-content">
            <section id="home" class="content-section active">
                <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi Wiki Unit Test</h1>
                <p>ƒê√¢y l√† trang t√†i li·ªáu t·ªïng h·ª£p c√°c ki·∫øn th·ª©c, nguy√™n t·∫Øc v√† b√†i h·ªçc th·ª±c t·∫ø v·ªÅ <span class="keyword" data-keyword="unit-testing">Unit Testing</span> trong ph√°t tri·ªÉn ph·∫ßn m·ªÅm. M·ª•c ti√™u c·ªßa trang wiki n√†y l√† bi·∫øn nh·ªØng ki·∫øn th·ª©c ph·ª©c t·∫°p th√†nh m·ªôt ngu·ªìn t√†i li·ªáu <strong>d·ªÖ h·ªçc, d·ªÖ tra c·ª©u</strong> cho c√°c l·∫≠p tr√¨nh vi√™n.</p>

                <h2>T√≥m t·∫Øt c·ªët l√µi</h2>
                <ul>
                    <li><strong><span class="keyword" data-keyword="unit-testing">Unit testing</span> l√† m·ªôt m·∫°ng l∆∞·ªõi an to√†n (safety net)</strong> gi√∫p ph√°t hi·ªán l·ªói h·ªìi quy (<span class="keyword" data-keyword="regression">regressions</span>) v√† duy tr√¨ t·ªëc ƒë·ªô ph√°t tri·ªÉn c·ªßa d·ª± √°n v·ªÅ l√¢u d√†i.</li>
                    <li>N·∫øu code c·ªßa b·∫°n <strong>kh√≥ ƒë·ªÉ vi·∫øt unit test</strong>, ƒë√≥ th∆∞·ªùng l√† m·ªôt d·∫•u hi·ªáu c·ªßa thi·∫øt k·∫ø k√©m (v√≠ d·ª•: <span class="keyword" data-keyword="tight-coupling">tight coupling</span> - li√™n k·∫øt ch·∫∑t ch·∫Ω). Ng∆∞·ª£c l·∫°i, code d·ªÖ test kh√¥ng ƒë·∫£m b·∫£o r·∫±ng ƒë√≥ l√† code ho√†n h·∫£o.</li>
                    <li><strong>M·ª•c ti√™u ch√≠nh khi vi·∫øt test:</strong>
                        <ol>
                            <li>Ph√°t hi·ªán l·ªói h·ªìi quy m·ªôt c√°ch hi·ªáu qu·∫£.</li>
                            <li>Gi·∫£m chi ph√≠ b·∫£o tr√¨ b·ªô test.</li>
                            <li>Cho ph√©p t√°i c·∫•u tr√∫c (<span class="keyword" data-keyword="refactor">refactor</span>) code m·ªôt c√°ch an to√†n v√† t·ª± tin.</li>
                        </ol>
                    </li>
                    <li><strong>Kh√¥ng c√≥ test:</strong> D·ª± √°n c√≥ th·ªÉ ph√°t tri·ªÉn nhanh l√∫c ƒë·∫ßu, nh∆∞ng s·∫Ω ch·∫≠m l·∫°i ƒë√°ng k·ªÉ v·ªÅ sau do s·ª± entropy c·ªßa m√£ ngu·ªìn (code ng√†y c√†ng ph·ª©c t·∫°p, r·ªëi r·∫Øm v√† d·ªÖ h·ªèng).</li>
                    <li><strong>C√≥ test:</strong> Vi·ªác s·ª≠a ƒë·ªïi v√† t√°i c·∫•u tr√∫c code tr·ªü n√™n an to√†n h∆°n, gi√∫p d·ª± √°n duy tr√¨ ƒë∆∞·ª£c ch·∫•t l∆∞·ª£ng v√† t·ªëc ƒë·ªô.</li>
                </ul>

                <blockquote>
                    <p>Code kh√¥ng ph·∫£i l√† m·ªôt t√†i s·∫£n (asset), n√≥ l√† m·ªôt kho·∫£n n·ª£ (liability). Code c√†ng nhi·ªÅu, r·ªßi ro ti·ªÅm ·∫©n bug c√†ng l·ªõn. <span class="keyword" data-keyword="unit-test">Unit test</span> ch√≠nh l√† "t·∫•m khi√™n" b·∫£o v·ªá b·∫°n kh·ªèi kho·∫£n n·ª£ ƒë√≥.</p>
                </blockquote>
                <p>H√£y b·∫Øt ƒë·∫ßu kh√°m ph√° c√°c ch·ªß ƒë·ªÅ chi ti·∫øt h∆°n qua thanh ƒëi·ªÅu h∆∞·ªõng b√™n tr√°i!</p>
            </section>

            <section id="getting-started" class="content-section">
                <h1>B·∫Øt ƒë·∫ßu v·ªõi Unit Test</h1>
                <p>Ph·∫ßn n√†y s·∫Ω gi·ªõi thi·ªáu nh·ªØng kh√°i ni·ªám n·ªÅn t·∫£ng nh·∫•t m√† b·∫°n c·∫ßn n·∫Øm v·ªØng tr∆∞·ªõc khi ƒëi s√¢u v√†o c√°c k·ªπ thu·∫≠t chi ti·∫øt.</p>

                <h2>‚úÖ Test T·ªët vs. Test T·ªìi</h2>
                <p>M·ªôt b√†i test ƒë∆∞·ª£c coi l√† <strong>"t·ªët"</strong> khi n√≥ mang l·∫°i gi√° tr·ªã cao v·ªõi chi ph√≠ b·∫£o tr√¨ th·∫•p. Ng∆∞·ª£c l·∫°i, m·ªôt b√†i test <strong>"t·ªìi"</strong> s·∫Ω tr·ªü th√†nh g√°nh n·∫∑ng cho d·ª± √°n.</p>
                <ul>
                    <li><strong>Test T·ªët:</strong>
                        <ul>
                            <li>Ch·∫°y nhanh.</li>
                            <li>M·ª•c ƒë√≠ch r√µ r√†ng, d·ªÖ ƒë·ªçc.</li>
                            <li>ƒê·ªôc l·∫≠p, kh√¥ng ph·ª• thu·ªôc v√†o c√°c test kh√°c.</li>
                            <li>√çt chi ph√≠ b·∫£o tr√¨ khi code thay ƒë·ªïi (ch·ªëng ch·ªãu ƒë∆∞·ª£c <span class="keyword" data-keyword="refactor">refactor</span>).</li>
                            <li>T·∫≠p trung v√†o c√°c h√†nh vi (behavior) quan tr·ªçng c·ªßa h·ªá th·ªëng.</li>
                        </ul>
                    </li>
                    <li><strong>Test T·ªìi:</strong>
                        <ul>
                            <li>Ch·∫°y ch·∫≠m.</li>
                            <li>D·ªÖ b·ªã "v·ª°" (fail) d√π logic c·ªßa ·ª©ng d·ª•ng v·∫´n ƒë√∫ng.</li>
                            <li>C√≥ nhi·ªÅu code th·ª´a (<span class="keyword" data-keyword="boilerplate">boilerplate</span>).</li>
                            <li>G√¢y ra c√°c c·∫£nh b√°o gi·∫£ (<span class="keyword" data-keyword="false-positive">false positive</span>), l√†m m·∫•t ni·ªÅm tin c·ªßa l·∫≠p tr√¨nh vi√™n.</li>
                            <li>B·ªã tr√πng l·∫∑p (<span class="keyword" data-keyword="redundant">redundant</span>) v·ªõi c√°c test kh√°c.</li>
                        </ul>
                    </li>
                </ul>

                <h2>Ph√¢n lo·∫°i c√°c c·∫•p ƒë·ªô Test</h2>
                <p>Trong ph√°t tri·ªÉn ph·∫ßn m·ªÅm, c√≥ nhi·ªÅu c·∫•p ƒë·ªô ki·ªÉm th·ª≠ kh√°c nhau, m·ªói lo·∫°i c√≥ m·ªôt m·ª•c ƒë√≠ch ri√™ng. Ba lo·∫°i ph·ªï bi·∫øn nh·∫•t th∆∞·ªùng ƒë∆∞·ª£c minh h·ªça qua m√¥ h√¨nh <span class="keyword" data-keyword="test-pyramid">Kim t·ª± th√°p Ki·ªÉm th·ª≠</span>.</p>
                <ol>
                    <li><strong><span class="keyword" data-keyword="unit-test">Unit Test</span> (Ki·ªÉm th·ª≠ ƒë∆°n v·ªã):</strong>
                        <p><strong>M·ª•c ti√™u:</strong> Ki·ªÉm tra m·ªôt ƒë∆°n v·ªã (unit) code nh·ªè v√† c√¥ l·∫≠p (v√≠ d·ª•: m·ªôt h√†m, m·ªôt class).<br>
                        <strong>ƒê·∫∑c ƒëi·ªÉm:</strong> Ch·∫°y ho√†n to√†n trong b·ªô nh·ªõ (in-memory), kh√¥ng ph·ª• thu·ªôc v√†o c√°c h·ªá th·ªëng b√™n ngo√†i nh∆∞ <span class="keyword" data-keyword="database">database</span>, file system hay network. R·∫•t nhanh.</p>
                    </li>
                    <li><strong><span class="keyword" data-keyword="integration-test">Integration Test</span> (Ki·ªÉm th·ª≠ t√≠ch h·ª£p):</strong>
                        <p><strong>M·ª•c ti√™u:</strong> Ki·ªÉm tra s·ª± t∆∞∆°ng t√°c v√† ph·ªëi h·ª£p gi·ªØa hai hay nhi·ªÅu th√†nh ph·∫ßn c·ªßa h·ªá th·ªëng, ho·∫∑c gi·ªØa h·ªá th·ªëng c·ªßa b·∫°n v√† m·ªôt h·ªá th·ªëng b√™n ngo√†i (<span class="keyword" data-keyword="database">database</span>, <span class="keyword" data-keyword="api">API</span> c·ªßa b√™n th·ª© ba).<br>
                        <strong>ƒê·∫∑c ƒëi·ªÉm:</strong> Ch·∫≠m h∆°n <span class="keyword" data-keyword="unit-test">Unit Test</span> v√¨ c·∫ßn truy c·∫≠p v√†o c√°c t√†i nguy√™n ngo√†i process.</p>
                    </li>
                    <li><strong><span class="keyword" data-keyword="e2e-test">End-to-end (E2E) Test</span> (Ki·ªÉm th·ª≠ ƒë·∫ßu-cu·ªëi):</strong>
                        <p><strong>M·ª•c ti√™u:</strong> Ki·ªÉm tra to√†n b·ªô lu·ªìng ho·∫°t ƒë·ªông c·ªßa ·ª©ng d·ª•ng t·ª´ g√≥c nh√¨n c·ªßa ng∆∞·ªùi d√πng cu·ªëi.<br>
                        <strong>ƒê·∫∑c ƒëi·ªÉm:</strong> M√¥ ph·ªèng m·ªôt ng∆∞·ªùi d√πng th·∫≠t, t∆∞∆°ng t√°c t·ª´ giao di·ªán ng∆∞·ªùi d√πng (UI) xu·ªëng t·ªõi <span class="keyword" data-keyword="database">database</span>. R·∫•t ch·∫≠m v√† chi ph√≠ b·∫£o tr√¨ cao.</p>
                    </li>
                </ol>

                <h2>M√¥ h√¨nh <span class="keyword" data-keyword="test-pyramid">Kim t·ª± th√°p Ki·ªÉm th·ª≠ (Test Pyramid)</span></h2>
                <p>ƒê√¢y l√† m·ªôt m√¥ h√¨nh tr·ª±c quan gi√∫p ƒë·ªãnh h∆∞·ªõng chi·∫øn l∆∞·ª£c vi·∫øt test: h√£y vi·∫øt th·∫≠t nhi·ªÅu <span class="keyword" data-keyword="unit-test">Unit Test</span>, √≠t h∆°n <span class="keyword" data-keyword="integration-test">Integration Test</span> v√† s·ªë l∆∞·ª£ng <span class="keyword" data-keyword="e2e-test">E2E Test</span> l√† √≠t nh·∫•t.</p>
                <img src="images/test_pyramid.svg" alt="Test Pyramid">
            </section>

            <section id="structuring-metrics" class="content-section">
                <h1>C·∫•u tr√∫c v√† ƒê√°nh gi√° Test</h1>
                <p>Sau khi n·∫Øm ƒë∆∞·ª£c c√°c kh√°i ni·ªám c∆° b·∫£n, b∆∞·ªõc ti·∫øp theo l√† t√¨m hi·ªÉu c√°ch c·∫•u tr√∫c m·ªôt b√†i test cho d·ªÖ ƒë·ªçc v√† c√°ch ƒë√°nh gi√° b·ªô test c·ªßa b·∫°n m·ªôt c√°ch ƒë√∫ng ƒë·∫Øn.</p>

                <h2>M·∫´u <span class="keyword" data-keyword="aaa">AAA ‚Äî Arrange / Act / Assert</span></h2>
                <p>ƒê√¢y l√† m·ªôt m·∫´u c·∫•u tr√∫c (pattern) c·ª±c k·ª≥ ph·ªï bi·∫øn gi√∫p cho c√°c b√†i test tr·ªü n√™n r√µ r√†ng v√† nh·∫•t qu√°n. M·ªôt b√†i test n√™n ƒë∆∞·ª£c chia th√†nh 3 ph·∫ßn ri√™ng bi·ªát:</p>
                <ol>
                    <li><strong>Arrange (S·∫Øp ƒë·∫∑t):</strong>
                        <p><strong>M·ª•c ƒë√≠ch:</strong> Chu·∫©n b·ªã m·ªçi th·ª© c·∫ßn thi·∫øt ƒë·ªÉ b√†i test c√≥ th·ªÉ ch·∫°y.<br>
                        <strong>C√¥ng vi·ªác:</strong> Kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng, chu·∫©n b·ªã d·ªØ li·ªáu ƒë·∫ßu v√†o, thi·∫øt l·∫≠p c√°c <span class="keyword" data-keyword="mock">mock</span>/<span class="keyword" data-keyword="stub">stub</span>.</p>
                    </li>
                    <li><strong>Act (H√†nh ƒë·ªông):</strong>
                        <p><strong>M·ª•c ƒë√≠ch:</strong> Th·ª±c thi h√†nh vi (behavior) m√† b·∫°n mu·ªën ki·ªÉm tra.<br>
                        <strong>C√¥ng vi·ªác:</strong> G·ªçi ph∆∞∆°ng th·ª©c ho·∫∑c h√†m c·∫ßn test. Th√¥ng th∆∞·ªùng, ph·∫ßn n√†y ch·ªâ n√™n c√≥ m·ªôt d√≤ng code duy nh·∫•t.</p>
                    </li>
                    <li><strong>Assert (X√°c minh):</strong>
                        <p><strong>M·ª•c ƒë√≠ch:</strong> Ki·ªÉm tra xem k·∫øt qu·∫£ c·ªßa h√†nh ƒë·ªông c√≥ ƒë√∫ng nh∆∞ mong ƒë·ª£i hay kh√¥ng.<br>
                        <strong>C√¥ng vi·ªác:</strong> So s√°nh k·∫øt qu·∫£ tr·∫£ v·ªÅ ho·∫∑c tr·∫°ng th√°i c·ªßa ƒë·ªëi t∆∞·ª£ng v·ªõi m·ªôt gi√° tr·ªã k·ª≥ v·ªçng.</p>
                    </li>
                </ol>

                <div class="practice-link-box">
                    <p>üí° <strong>Xem th·ª±c h√†nh:</strong> ƒê·ªÉ xem c√°ch √°p d·ª•ng m·∫´u AAA v√†o th·ª±c t·∫ø, h√£y tham kh·∫£o c√°c v√≠ d·ª• trong ph·∫ßn <a href="#" class="nav-item" data-target="pytest-hands-on">Th·ª±c h√†nh PyTest</a> v√† <a href="#" class="nav-item" data-target="gtest-hands-on">Th·ª±c h√†nh GTest</a>.</p>
                </div>

                <h3>S∆° ƒë·ªì tu·∫ßn t·ª± c·ªßa m·∫´u AAA</h3>
                <p>S∆° ƒë·ªì n√†y minh h·ªça lu·ªìng ho·∫°t ƒë·ªông c·ªßa m·ªôt b√†i test theo m·∫´u AAA.</p>
                <img src="images/aaa_pattern_sequence.svg" alt="AAA Pattern Sequence">

                <h2>C√°c ch·ªâ s·ªë <span class="keyword" data-keyword="code-coverage">ƒê·ªô bao ph·ªß (Coverage Metrics)</span> ‚Äî Hi·ªÉu cho ƒë√∫ng</h2>
                <p><span class="keyword" data-keyword="code-coverage">ƒê·ªô bao ph·ªß (code coverage)</span> l√† m·ªôt ch·ªâ s·ªë ƒëo l∆∞·ªùng t·ª∑ l·ªá code c·ªßa b·∫°n ƒë∆∞·ª£c th·ª±c thi b·ªüi c√°c b√†i test. Tuy nhi√™n, ƒë√¢y l√† m·ªôt ch·ªâ s·ªë r·∫•t d·ªÖ b·ªã hi·ªÉu sai.</p>
                <ul>
                    <li><strong>Line coverage (ƒê·ªô ph·ªß d√≤ng l·ªánh):</strong> T·ª∑ l·ªá ph·∫ßn trƒÉm s·ªë d√≤ng code ƒë√£ ƒë∆∞·ª£c ch·∫°y qua b·ªüi b·ªô test.</li>
                    <li><strong>Branch coverage (ƒê·ªô ph·ªß nh√°nh):</strong> T·ª∑ l·ªá ph·∫ßn trƒÉm c√°c nh√°nh quy·∫øt ƒë·ªãnh (v√≠ d·ª•: <code>if/else</code>, <code>switch/case</code>) ƒë√£ ƒë∆∞·ª£c th·ª±c thi. ƒê√¢y l√† ch·ªâ s·ªë quan tr·ªçng h∆°n line coverage.</li>
                </ul>

                <h3>C√¥ng th·ª©c t√≠nh Branch Coverage</h3>
                <blockquote>
                    <p>Branch coverage = (S·ªë nh√°nh ƒë√£ ƒë∆∞·ª£c test ch·∫°y qua) / (T·ªïng s·ªë nh√°nh trong m√£ ngu·ªìn)</p>
                </blockquote>

                <h3>Coverage l√† m·ªôt ch·ªâ b√°o, kh√¥ng ph·∫£i m·ª•c ti√™u</h3>
                <p>H√£y nh·ªõ r·∫±ng, coverage l√† m·ªôt c√¥ng c·ª• ƒë·ªÉ t√¨m ra nh·ªØng ph·∫ßn code <strong>ch∆∞a ƒë∆∞·ª£c test</strong>, ch·ª© kh√¥ng ph·∫£i l√† th∆∞·ªõc ƒëo ch·∫•t l∆∞·ª£ng c·ªßa b·ªô test.</p>
                <ul>
                    <li><strong>Coverage th·∫•p (v√≠ d·ª•: < 50%):</strong> Ch·∫Øc ch·∫Øn l√† m·ªôt d·∫•u hi·ªáu x·∫•u. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† m·ªôt ph·∫ßn l·ªõn code c·ªßa b·∫°n ch∆∞a h·ªÅ ƒë∆∞·ª£c ki·ªÉm tra.</li>
                    <li><strong>Coverage cao (v√≠ d·ª•: 90-100%):</strong> <strong>Kh√¥ng ƒë·∫£m b·∫£o</strong> r·∫±ng b·ªô test c·ªßa b·∫°n t·ªët. M·ªôt b√†i test c√≥ th·ªÉ ch·∫°y qua 100% d√≤ng code nh∆∞ng l·∫°i thi·∫øu c√°c <code>assert</code> quan tr·ªçng, ho·∫∑c ch·ªâ ki·ªÉm tra nh·ªØng th·ª© t·∫ßm th∆∞·ªùng.</li>
                </ul>
                <p><strong>L·ªùi khuy√™n:</strong> ƒê·ª´ng ƒëu·ªïi theo con s·ªë coverage. H√£y t·∫≠p trung v√†o vi·ªác vi·∫øt nh·ªØng b√†i test c√≥ √Ω nghƒ©a, ki·ªÉm tra c√°c logic nghi·ªáp v·ª• quan tr·ªçng.</p>
            </section>

            <section id="london-vs-classical" class="content-section">
                <h1>Hai tr∆∞·ªùng ph√°i Unit Testing: London vs. Classical</h1>
                <p>Trong c·ªông ƒë·ªìng ph√°t tri·ªÉn ph·∫ßn m·ªÅm, c√≥ hai tr∆∞·ªùng ph√°i t∆∞ duy ch√≠nh v·ªÅ c√°ch ti·∫øp c·∫≠n <span class="keyword" data-keyword="unit-testing">unit testing</span>, ƒë·∫∑c bi·ªát l√† v·ªÅ v·∫•n ƒë·ªÅ "c√°ch ly" (isolation) v√† vi·ªác s·ª≠ d·ª•ng c√°c ƒë·ªëi t∆∞·ª£ng gi·∫£ (<span class="keyword" data-keyword="test-double">test doubles</span>).</p>

                <h2>Tr∆∞·ªùng ph√°i <span class="keyword" data-keyword="london-school">London (c√≤n g·ªçi l√† Mockist)</span></h2>
                <ul>
                    <li><strong>Tri·∫øt l√Ω:</strong> M·ªôt "unit" (ƒë∆°n v·ªã) ƒë∆∞·ª£c ki·ªÉm th·ª≠ l√† m·ªôt <strong>class duy nh·∫•t</strong>. M·ªçi <span class="keyword" data-keyword="dependency">dependency</span> (ƒë·ªëi t∆∞·ª£ng ph·ª• thu·ªôc) c·ªßa class ƒë√≥, d√π l√† m·ªôt class kh√°c trong h·ªá th·ªëng c·ªßa b·∫°n, ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c thay th·∫ø b·∫±ng <span class="keyword" data-keyword="mock">mock</span>.</li>
                    <li><strong>T·∫≠p trung v√†o T∆∞∆°ng t√°c (Interaction):</strong> C√°c b√†i test theo tr∆∞·ªùng ph√°i n√†y x√°c minh xem class ƒëang ƒë∆∞·ª£c test (<span class="keyword" data-keyword="sut">SUT - System Under Test</span>) c√≥ g·ªçi ƒë√∫ng c√°c ph∆∞∆°ng th·ª©c c·ªßa <span class="keyword" data-keyword="dependency">dependency</span> hay kh√¥ng. ƒê√¢y ƒë∆∞·ª£c g·ªçi l√† <em>interaction testing</em>.</li>
                    <li><strong>∆Øu ƒëi·ªÉm:</strong>
                        <ul>
                            <li>Khi m·ªôt b√†i test fail, b·∫°n bi·∫øt ch√≠nh x√°c class n√†o ƒëang b·ªã l·ªói.</li>
                            <li>Kh√¥ng c·∫ßn ph·∫£i kh·ªüi t·∫°o m·ªôt ƒë·ªì th·ªã ƒë·ªëi t∆∞·ª£ng (object graph) ph·ª©c t·∫°p.</li>
                        </ul>
                    </li>
                    <li><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong>
                        <ul>
                            <li>C√°c b√†i test b·ªã <strong>g·∫Øn ch·∫∑t v√†o <span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t (implementation details)</span></strong>. N·∫øu b·∫°n <span class="keyword" data-keyword="refactor">refactor</span> code b·∫±ng c√°ch thay ƒë·ªïi c√°ch c√°c class t∆∞∆°ng t√°c v·ªõi nhau (nh∆∞ng v·∫´n gi·ªØ ƒë√∫ng k·∫øt qu·∫£ cu·ªëi c√πng), c√°c b√†i test s·∫Ω b·ªã h·ªèng (<span class="keyword" data-keyword="false-positive">false positive</span>). ƒêi·ªÅu n√†y l√†m tƒÉng ƒë√°ng k·ªÉ chi ph√≠ b·∫£o tr√¨.</li>
                        </ul>
                    </li>
                </ul>

                <h2>Tr∆∞·ªùng ph√°i <span class="keyword" data-keyword="classical-school">Classical (c√≤n g·ªçi l√† Detroit ho·∫∑c Classicist)</span></h2>
                <ul>
                    <li><strong>Tri·∫øt l√Ω:</strong> M·ªôt "unit" l√† m·ªôt <strong>h√†nh vi nghi·ªáp v·ª• (unit of behavior)</strong>. N√≥ c√≥ th·ªÉ bao g·ªìm m·ªôt class ho·∫∑c m·ªôt nh√≥m c√°c class l√†m vi·ªác c√πng nhau ƒë·ªÉ ho√†n th√†nh m·ªôt nhi·ªám v·ª•.</li>
                    <li><strong>T·∫≠p trung v√†o K·∫øt qu·∫£ (State):</strong> C√°c b√†i test theo tr∆∞·ªùng ph√°i n√†y ki·ªÉm tra k·∫øt qu·∫£ cu·ªëi c√πng ho·∫∑c s·ª± thay ƒë·ªïi tr·∫°ng th√°i c·ªßa h·ªá th·ªëng sau khi h√†nh ƒë·ªông ƒë∆∞·ª£c th·ª±c hi·ªán. ƒê√¢y ƒë∆∞·ª£c g·ªçi l√† <em>state testing</em>.</li>
                    <li><strong>C√°ch ly:</strong> Tr∆∞·ªùng ph√°i n√†y ƒë·ªãnh nghƒ©a "c√°ch ly" l√† vi·ªác c√°c <strong>b√†i test ph·∫£i ƒë·ªôc l·∫≠p v·ªõi nhau</strong>. Test A kh√¥ng ƒë∆∞·ª£c ·∫£nh h∆∞·ªüng ƒë·∫øn k·∫øt qu·∫£ c·ªßa Test B.</li>
                    <li><strong>S·ª≠ d·ª•ng <span class="keyword" data-keyword="test-double">Test Doubles</span>:</strong> Ch·ªâ s·ª≠ d·ª•ng <span class="keyword" data-keyword="mock">mock</span>/<span class="keyword" data-keyword="stub">stub</span> cho c√°c <strong><span class="keyword" data-keyword="dependency">dependency</span> th·ª±c s·ª± b√™n ngo√†i v√† ch·∫≠m</strong>, nh∆∞ network, <span class="keyword" data-keyword="database">database</span>, file system (ƒë∆∞·ª£c g·ªçi l√† <em><span class="keyword" data-keyword="shared-dependency">shared dependencies</span></em>). C√°c class th√¥ng th∆∞·ªùng trong c√πng m·ªôt h·ªá th·ªëng ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp.</li>
                    <li><strong>∆Øu ƒëi·ªÉm:</strong>
                        <ul>
                            <li>C√°c b√†i test c√≥ kh·∫£ nƒÉng <strong>ch·ªëng ch·ªãu <span class="keyword" data-keyword="refactor">refactoring</span> cao</strong>. B·∫°n c√≥ th·ªÉ t·ª± do thay ƒë·ªïi c·∫•u tr√∫c code n·ªôi b·ªô mi·ªÖn l√† k·∫øt qu·∫£ ƒë·∫ßu ra kh√¥ng ƒë·ªïi.</li>
                            <li>B·ªô test ph·∫£n √°nh ƒë√∫ng h∆°n gi√° tr·ªã nghi·ªáp v·ª• c·ªßa ·ª©ng d·ª•ng.</li>
                        </ul>
                    </li>
                    <li><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong>
                        <ul>
                            <li>Khi m·ªôt b√†i test fail, c√≥ th·ªÉ kh√≥ x√°c ƒë·ªãnh ngay l·∫≠p t·ª©c class n√†o g√¢y ra l·ªói.</li>
                        </ul>
                    </li>
                </ul>

                <h2>L·ªùi khuy√™n</h2>
                <p>C·∫£ hai tr∆∞·ªùng ph√°i ƒë·ªÅu c√≥ ∆∞u v√† nh∆∞·ª£c ƒëi·ªÉm ri√™ng. Tuy nhi√™n, ƒë·ªÉ x√¢y d·ª±ng m·ªôt b·ªô test b·ªÅn v·ªØng v√† √≠t chi ph√≠ b·∫£o tr√¨, <strong>tr∆∞·ªùng ph√°i <span class="keyword" data-keyword="classical-school">Classical</span> th∆∞·ªùng ƒë∆∞·ª£c ∆∞u ti√™n h∆°n</strong>. Vi·ªác c√°c b√†i test c√≥ kh·∫£ nƒÉng ch·ªëng ch·ªãu <span class="keyword" data-keyword="refactor">refactoring</span> l√† m·ªôt trong nh·ªØng y·∫øu t·ªë quan tr·ªçng nh·∫•t c·ªßa m·ªôt b·ªô test t·ªët.</p>
                <blockquote>
                    <p><strong>Quan tr·ªçng:</strong> H√£y ch·ªçn m·ªôt phong c√°ch nh·∫•t qu√°n cho to√†n b·ªô ƒë·ªôi nh√≥m v√† tu√¢n th·ªß n√≥. Vi·ªác tr·ªôn l·∫´n hai phong c√°ch n√†y trong c√πng m·ªôt codebase c√≥ th·ªÉ d·∫´n ƒë·∫øn nh·ªØng cu·ªôc tranh c√£i kh√¥ng c·∫ßn thi·∫øt v√† l√†m cho b·ªô test tr·ªü n√™n kh√≥ hi·ªÉu.</p>
                </blockquote>
            </section>

            <section id="test-data-patterns" class="content-section">
                <h1>C√°c m·∫´u (Patterns) x·ª≠ l√Ω d·ªØ li·ªáu Test</h1>
                <p>Khi vi·∫øt <span class="keyword" data-keyword="unit-test">unit test</span>, ph·∫ßn <code>Arrange</code> (chu·∫©n b·ªã d·ªØ li·ªáu) th∆∞·ªùng l√† ph·∫ßn d√†i d√≤ng v√† l·∫∑p ƒëi l·∫∑p l·∫°i nh·∫•t. N·∫øu kh√¥ng ƒë∆∞·ª£c qu·∫£n l√Ω t·ªët, n√≥ c√≥ th·ªÉ l√†m cho c√°c b√†i test tr·ªü n√™n kh√≥ ƒë·ªçc v√† kh√≥ b·∫£o tr√¨. D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë m·∫´u thi·∫øt k·∫ø ph·ªï bi·∫øn gi√∫p b·∫°n gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y.</p>

                <h2>V·∫•n ƒë·ªÅ: Ph·∫ßn <code>Arrange</code> qu√° d√†i</h2>
                <p>H√£y xem x√©t m·ªôt v√≠ d·ª• v·ªõi c√°c model <code>Customer</code>, <code>Order</code>, <code>Item</code>.</p>
<pre><code class="language-python"># models.py
class Item:
    def __init__(self, name: str, price: float):
        self.name = name
        self.price = price

class Customer:
    def __init__(self, first_name: str, is_vip: bool = False):
        self.first_name = first_name
        self.is_vip = is_vip

class Order:
    def __init__(self, customer: Customer):
        self.customer = customer
        self.items = []

    def add_item(self, item: Item):
        self.items.append(item)

    @property
    def total(self) -> float:
        return sum(i.price for i in self.items)

    def apply_discount(self):
        if self.customer.is_vip:
            # VIP: 10% off
            total = self.total
            return round(total * 0.9, 2)
        return round(self.total, 2)
</code></pre>
                <p>M·ªôt b√†i test th√¥ng th∆∞·ªùng c√≥ th·ªÉ tr√¥ng nh∆∞ th·∫ø n√†y:</p>
<pre><code class="language-python"># test_standard.py
from models import Item, Customer, Order

def test_order_total_with_discount_standard():
    # ARRANGE (r·∫•t nhi·ªÅu chi ti·∫øt, kh√¥ng ph·∫£i t·∫•t c·∫£ ƒë·ªÅu quan tr·ªçng)
    customer = Customer(first_name="Hoang", is_vip=True)
    order = Order(customer)
    order.add_item(Item("Laptop", 1000))
    order.add_item(Item("Mouse", 50))

    # ACT
    discounted_price = order.apply_discount()

    # ASSERT
    assert discounted_price == 945.0
</code></pre>
                <p>Trong b√†i test tr√™n, c√°c chi ti·∫øt nh∆∞ <code>"Hoang"</code>, <code>"Laptop"</code>, <code>"Mouse"</code> kh√¥ng th·ª±c s·ª± quan tr·ªçng ƒë·ªëi v·ªõi logic c·∫ßn test (logic gi·∫£m gi√° cho kh√°ch VIP). Ch√∫ng l√†m cho b√†i test b·ªã "nhi·ªÖu".</p>

                <h2>M·∫´u 1: Object Mother</h2>
                <p><strong>√ù t∆∞·ªüng:</strong> T·∫°o m·ªôt class "M·∫π" ch·ª©a c√°c ph∆∞∆°ng th·ª©c <code>static</code> ƒë·ªÉ t·∫°o ra c√°c phi√™n b·∫£n ph·ªï bi·∫øn c·ªßa m·ªôt ƒë·ªëi t∆∞·ª£ng.</p>
<pre><code class="language-python"># test_object_mother.py
from models import Item, Order

class CustomerMother:
    @staticmethod
    def vip():
        from models import Customer
        return Customer(first_name="VIP Customer", is_vip=True)

    @staticmethod
    def regular():
        from models import Customer
        return Customer(first_name="Regular Customer", is_vip=False)

def test_order_total_with_object_mother():
    # ARRANGE (g·ªçn g√†ng h∆°n, che gi·∫•u chi ti·∫øt kh√¥ng c·∫ßn thi·∫øt)
    customer = CustomerMother.vip()
    order = Order(customer)
    order.add_item(Item("Laptop", 1000))

    # ACT
    discounted_price = order.apply_discount()

    # ASSERT
    assert discounted_price == 900.0
</code></pre>
                <ul>
                    <li><strong>∆Øu ƒëi·ªÉm:</strong> Nhanh, g·ªçn, d·ªÖ s·ª≠ d·ª•ng cho c√°c tr∆∞·ªùng h·ª£p ph·ªï bi·∫øn.</li>
                    <li><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> K√©m linh ho·∫°t. N·∫øu b·∫°n c·∫ßn m·ªôt kh√°ch h√†ng VIP nh∆∞ng c√≥ t√™n kh√°c, b·∫°n s·∫Ω ph·∫£i th√™m m·ªôt ph∆∞∆°ng th·ª©c m·ªõi ho·∫∑c s·ª≠a ƒë·ªïi ƒë·ªëi t∆∞·ª£ng sau khi t·∫°o.</li>
                </ul>

                <h2>M·∫´u 2: Test Data Builder</h2>
                <p><strong>√ù t∆∞·ªüng:</strong> T·∫°o m·ªôt class <code>Builder</code> v·ªõi m·ªôt <span class="keyword" data-keyword="api">API</span> linh ho·∫°t (fluent interface) cho ph√©p b·∫°n t√πy ch·ªânh c√°c thu·ªôc t√≠nh c·ªßa ƒë·ªëi t∆∞·ª£ng m·ªôt c√°ch d·ªÖ d√†ng.</p>
<pre><code class="language-python"># test_builder.py
from models import Item, Order

class CustomerBuilder:
    def __init__(self):
        self._first_name = "Default Name"
        self._is_vip = False

    def with_vip(self, is_vip: bool):
        self._is_vip = is_vip
        return self

    def with_name(self, name: str):
        self._first_name = name
        return self

    def build(self):
        from models import Customer
        return Customer(first_name=self._first_name, is_vip=self._is_vip)

def test_order_with_builder():
    # ARRANGE (linh ho·∫°t v√† r·∫•t d·ªÖ ƒë·ªçc)
    customer = CustomerBuilder().with_vip(True).with_name("An").build()
    order = Order(customer)
    order.add_item(Item("Pen", 10))

    # ACT
    discounted_price = order.apply_discount()

    # ASSERT
    assert discounted_price == 9.0
</code></pre>
                <ul>
                    <li><strong>∆Øu ƒëi·ªÉm:</strong> R·∫•t linh ho·∫°t, d·ªÖ ƒë·ªçc, th·ªÉ hi·ªán r√µ √Ω ƒë·ªãnh c·ªßa b√†i test (ch·ªâ nh·ªØng thu·ªôc t√≠nh ƒë∆∞·ª£c t√πy ch·ªânh m·ªõi quan tr·ªçng).</li>
                    <li><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> C·∫ßn vi·∫øt nhi·ªÅu code h∆°n m·ªôt ch√∫t ƒë·ªÉ t·∫°o builder.</li>
                </ul>

                <h2>Khi n√†o n√™n d√πng m·∫´u n√†o?</h2>
                <ul>
                    <li><strong>Object Mother:</strong> Ph√π h·ª£p cho c√°c ƒë·ªëi t∆∞·ª£ng ƒë∆°n gi·∫£n, c√≥ √≠t bi·∫øn th·ªÉ v√† ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i.</li>
                    <li><strong>Test Data Builder:</strong> L√† l·ª±a ch·ªçn t·ªët nh·∫•t cho c√°c ƒë·ªëi t∆∞·ª£ng ph·ª©c t·∫°p ho·∫∑c khi b·∫°n c·∫ßn nhi·ªÅu bi·∫øn th·ªÉ kh√°c nhau trong c√°c b√†i test. ƒê√¢y th∆∞·ªùng l√† m·∫´u ƒë∆∞·ª£c ∆∞u ti√™n trong c√°c d·ª± √°n l·ªõn.</li>
                </ul>
            </section>

            <section id="four-pillars" class="content-section">
                <h1>B·ªën tr·ª• c·ªôt c·ªßa m·ªôt Unit Test t·ªët</h1>
                <p>ƒê·ªÉ m·ªôt b√†i test th·ª±c s·ª± c√≥ gi√° tr·ªã, n√≥ kh√¥ng ch·ªâ c·∫ßn t√¨m ra l·ªói. M·ªôt b√†i test t·ªët ph·∫£i c√¢n b·∫±ng gi·ªØa vi·ªác ph√°t hi·ªán l·ªói v√† chi ph√≠ b·∫£o tr√¨ n√≥. T√°c gi·∫£ Vladimir Khorikov ƒë√£ ƒë·ªãnh nghƒ©a m·ªôt h·ªá th·ªëng g·ªìm b·ªën tr·ª• c·ªôt ƒë·ªÉ ƒë√°nh gi√° ch·∫•t l∆∞·ª£ng c·ªßa m·ªôt <span class="keyword" data-keyword="unit-test">unit test</span>.</p>
                <p>M·ªôt b√†i test t·ªët ph·∫£i ƒë·ª©ng v·ªØng tr√™n c·∫£ b·ªën tr·ª• c·ªôt n√†y:</p>
                <ol>
                    <li><strong>Protection against <span class="keyword" data-keyword="regression">regressions</span> (B·∫£o v·ªá kh·ªèi l·ªói h·ªìi quy)</strong></li>
                    <li><strong>Resistance to <span class="keyword" data-keyword="refactor">refactoring</span> (Ch·ªëng ch·ªãu ƒë∆∞·ª£c t√°i c·∫•u tr√∫c)</strong></li>
                    <li><strong>Fast feedback (Ph·∫£n h·ªìi nhanh)</strong></li>
                    <li><strong>Maintainability (D·ªÖ b·∫£o tr√¨)</strong></li>
                </ol>
                <hr>
                <h2>Tr·ª• c·ªôt 1: B·∫£o v·ªá kh·ªèi l·ªói h·ªìi quy</h2>
                <p>ƒê√¢y l√† m·ª•c ƒë√≠ch c∆° b·∫£n nh·∫•t c·ªßa m·ªçi b√†i test.</p>
                <ul>
                    <li><strong>L·ªói h·ªìi quy (<span class="keyword" data-keyword="regression">Regression</span>) l√† g√¨?</strong> L√† khi m·ªôt t√≠nh nƒÉng ƒëang ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng b·ªóng d∆∞ng b·ªã h·ªèng sau khi b·∫°n thay ƒë·ªïi code ·ªü m·ªôt n∆°i kh√°c.</li>
                    <li><strong>L√†m sao ƒë·ªÉ m·ªôt b√†i test c√≥ kh·∫£ nƒÉng b·∫£o v·ªá t·ªët?</strong>
                        <ul>
                            <li><strong>Th·ª±c thi nhi·ªÅu code:</strong> B√†i test ch·∫°y qua c√†ng nhi·ªÅu logic nghi·ªáp v·ª• th√¨ kh·∫£ nƒÉng ph√°t hi·ªán l·ªói c√†ng cao.</li>
                            <li><strong>Ki·ªÉm tra code ph·ª©c t·∫°p:</strong> Test m·ªôt thu·∫≠t to√°n ph·ª©c t·∫°p c√≥ gi√° tr·ªã h∆°n l√† test m·ªôt h√†m getter/setter ƒë∆°n gi·∫£n.</li>
                            <li><strong>T·∫≠p trung v√†o nghi·ªáp v·ª• c·ªët l√µi:</strong> Test c√°c logic quan tr·ªçng nh∆∞ thanh to√°n, ph√¢n quy·ªÅn s·∫Ω c√≥ gi√° tr·ªã cao h∆°n.</li>
                        </ul>
                    </li>
                    <li><strong>L·ªùi khuy√™n:</strong> ƒê·ª´ng l√£ng ph√≠ th·ªùi gian test nh·ªØng ƒëo·∫°n code t·∫ßm th∆∞·ªùng (trivial code) kh√¥ng ch·ª©a logic.</li>
                </ul>
                <hr>
                <h2>Tr·ª• c·ªôt 2: Ch·ªëng ch·ªãu ƒë∆∞·ª£c t√°i c·∫•u tr√∫c</h2>
                <p>ƒê√¢y l√† tr·ª• c·ªôt quan tr·ªçng nh·∫•t v√† th∆∞·ªùng b·ªã b·ªè qua nh·∫•t, quy·∫øt ƒë·ªãnh chi ph√≠ b·∫£o tr√¨ c·ªßa b·ªô test.</p>
                <ul>
                    <li><strong>T√°i c·∫•u tr√∫c (<span class="keyword" data-keyword="refactor">Refactoring</span>) l√† g√¨?</strong> L√† vi·ªác thay ƒë·ªïi c·∫•u tr√∫c code b√™n trong (v√≠ d·ª•: t·ªëi ∆∞u thu·∫≠t to√°n, ƒë·ªïi t√™n bi·∫øn) m√† <strong>kh√¥ng l√†m thay ƒë·ªïi <span class="keyword" data-keyword="observable-behavior">h√†nh vi c√≥ th·ªÉ quan s√°t ƒë∆∞·ª£c b√™n ngo√†i</span></strong>.</li>
                    <li><strong>B√°o ƒë·ªông gi·∫£ (<span class="keyword" data-keyword="false-positive">False Positive</span>):</strong> N·∫øu b·∫°n <span class="keyword" data-keyword="refactor">t√°i c·∫•u tr√∫c</span> code m√† b√†i test b·ªã "ƒë·ªè" (fail), trong khi ch·ª©c nƒÉng v·∫´n ƒë√∫ng, th√¨ b√†i test ƒë√≥ ƒë√£ t·∫°o ra m·ªôt b√°o ƒë·ªông gi·∫£.</li>
                    <li><strong>T·∫°i sao b√°o ƒë·ªông gi·∫£ l·∫°i nguy hi·ªÉm?</strong>
                        <ul>
                            <li><strong>M·∫•t ni·ªÅm tin:</strong> Khi test b√°o l·ªói gi·∫£ qu√° nhi·ªÅu, l·∫≠p tr√¨nh vi√™n s·∫Ω d·∫ßn m·∫•t tin t∆∞·ªüng v√†o b·ªô test. H·ªç s·∫Ω b·∫Øt ƒë·∫ßu l·ªù ƒëi c√°c c·∫£nh b√°o, v√† ƒë√≥ l√† l√∫c l·ªói th·∫≠t s·ª± (true positive) s·∫Ω b·ªã b·ªè l·ªçt.</li>
                            <li><strong>Ng·∫°i thay ƒë·ªïi:</strong> M·ªôt b·ªô test "mong manh" (brittle) s·∫Ω c·∫£n tr·ªü vi·ªác t√°i c·∫•u tr√∫c, khi·∫øn cho codebase ng√†y c√†ng xu·ªëng c·∫•p.</li>
                        </ul>
                    </li>
                    <li><strong>L√†m sao ƒë·ªÉ test ch·ªëng ch·ªãu ƒë∆∞·ª£c t√°i c·∫•u tr√∫c?</strong> H√£y ki·ªÉm tra <strong>"C√°i g√¨" (What - k·∫øt qu·∫£ cu·ªëi c√πng)</strong> thay v√¨ <strong>"L√†m th·∫ø n√†o" (How - c√°c b∆∞·ªõc th·ª±c hi·ªán b√™n trong)</strong>.</li>
                </ul>
                <hr>
                <h2>Tr·ª• c·ªôt 3: Ph·∫£n h·ªìi nhanh</h2>
                <p>T·ªëc ƒë·ªô l√† y·∫øu t·ªë quy·∫øt ƒë·ªãnh t·∫ßn su·∫•t b·∫°n ch·∫°y b·ªô test.</p>
                <ul>
                    <li><strong>V√≤ng l·∫∑p ph·∫£n h·ªìi (Feedback Loop):</strong> Test c√†ng nhanh, b·∫°n c√†ng c√≥ th·ªÉ ch·∫°y ch√∫ng th∆∞·ªùng xuy√™n h∆°n. ƒêi·ªÅu n√†y gi√∫p b·∫°n ph√°t hi·ªán l·ªói ngay khi n√≥ v·ª´a ƒë∆∞·ª£c t·∫°o ra, l√†m cho vi·ªác s·ª≠a l·ªói tr·ªü n√™n d·ªÖ d√†ng v√† √≠t t·ªën k√©m h∆°n r·∫•t nhi·ªÅu.</li>
                    <li><strong>Ph√¢n bi·ªát <span class="keyword" data-keyword="unit-test">Unit Test</span> v√† <span class="keyword" data-keyword="integration-test">Integration Test</span>:</strong> ƒê√¢y ch√≠nh l√† y·∫øu t·ªë kh√°c bi·ªát l·ªõn nh·∫•t. <span class="keyword" data-keyword="unit-test">Unit test</span> ph·∫£i ch·∫°y trong v√†i mili gi√¢y, trong khi <span class="keyword" data-keyword="integration-test">integration test</span> c√≥ th·ªÉ m·∫•t v√†i gi√¢y ho·∫∑c h∆°n.</li>
                </ul>
                <hr>
                <h2>Tr·ª• c·ªôt 4: D·ªÖ b·∫£o tr√¨</h2>
                <p>Code test c≈©ng quan tr·ªçng nh∆∞ code s·∫£n ph·∫©m. M·ªôt b√†i test kh√≥ ƒë·ªçc, kh√≥ ch·∫°y s·∫Ω tr·ªü th√†nh g√°nh n·∫∑ng.</p>
                <ul>
                    <li><strong>ƒê·ªô kh√≥ hi·ªÉu:</strong>
                        <ul>
                            <li><strong>Ng·∫Øn g·ªçn:</strong> M·ªôt b√†i test n√™n ng·∫Øn g·ªçn v√† t·∫≠p trung v√†o m·ªôt k·ªãch b·∫£n duy nh·∫•t.</li>
                            <li><strong>D·ªÖ ƒë·ªçc:</strong> S·ª≠ d·ª•ng c√°c m·∫´u nh∆∞ <span class="keyword" data-keyword="aaa">AAA</span>, ƒë·∫∑t t√™n test r√µ r√†ng ƒë·ªÉ th·ªÉ hi·ªán √Ω ƒë·ªãnh.</li>
                        </ul>
                    </li>
                    <li><strong>ƒê·ªô kh√≥ v·∫≠n h√†nh:</strong>
                        <ul>
                            <li>M·ªôt <span class="keyword" data-keyword="unit-test">unit test</span> t·ªët ph·∫£i c√≥ th·ªÉ ch·∫°y m√† kh√¥ng c·∫ßn m·ªôt m√¥i tr∆∞·ªùng ph·ª©c t·∫°p (kh√¥ng c·∫ßn <span class="keyword" data-keyword="database">database</span>, kh√¥ng c·∫ßn server, kh√¥ng c·∫ßn file c·∫•u h√¨nh).</li>
                        </ul>
                    </li>
                </ul>
                <hr>
                <h2>S·ª± ƒë√°nh ƒë·ªïi</h2>
                <p>Kh√¥ng th·ªÉ c√≥ m·ªôt b√†i test ho√†n h·∫£o ƒë·∫°t ƒëi·ªÉm t·ªëi ƒëa ·ªü c·∫£ 4 tr·ª• c·ªôt. S·∫Ω lu√¥n c√≥ s·ª± ƒë√°nh ƒë·ªïi, ƒë·∫∑c bi·ªát l√† gi·ªØa <strong>Tr·ª• c·ªôt 1 (B·∫£o v·ªá)</strong> v√† <strong>Tr·ª• c·ªôt 2 (Ch·ªëng ch·ªãu <span class="keyword" data-keyword="refactor">refactor</span>) & 3 (T·ªëc ƒë·ªô)</strong>.</p>
                <ul>
                    <li><strong><span class="keyword" data-keyword="e2e-test">E2E Test</span>:</strong> B·∫£o v·ªá t·ªët nh·∫•t, ch·ªëng ch·ªãu <span class="keyword" data-keyword="refactor">refactor</span> t·ªët, nh∆∞ng ph·∫£n h·ªìi c·ª±c k·ª≥ ch·∫≠m.</li>
                    <li><strong><span class="keyword" data-keyword="unit-test">Unit Test</span> mong manh:</strong> B·∫£o v·ªá t·ªët, ph·∫£n h·ªìi nhanh, nh∆∞ng ch·ªëng ch·ªãu <span class="keyword" data-keyword="refactor">refactor</span> c·ª±c t·ªá.</li>
                    <li><strong><span class="keyword" data-keyword="unit-test">Unit Test</span> t·ªët:</strong> C√¢n b·∫±ng gi·ªØa c·∫£ b·ªën y·∫øu t·ªë, trong ƒë√≥ <strong>kh·∫£ nƒÉng ch·ªëng ch·ªãu <span class="keyword" data-keyword="refactor">refactor</span> v√† d·ªÖ b·∫£o tr√¨ l√† kh√¥ng th·ªÉ nh√¢n nh∆∞·ª£ng</strong>.</li>
                </ul>
            </section>

            <section id="behavior-vs-implementation" class="content-section">
                <h1>Behavior vs. Implementation Details</h1>
                <p>ƒê·ªÉ vi·∫øt ƒë∆∞·ª£c nh·ªØng b√†i test c√≥ kh·∫£ nƒÉng ch·ªëng ch·ªãu t√°i c·∫•u tr√∫c (resistant to <span class="keyword" data-keyword="refactor">refactoring</span>), b·∫°n bu·ªôc ph·∫£i hi·ªÉu r√µ v√† ph√¢n bi·ªát ƒë∆∞·ª£c ƒë√¢u l√† <strong><span class="keyword" data-keyword="observable-behavior">h√†nh vi quan s√°t ƒë∆∞·ª£c</span></strong> v√† ƒë√¢u l√† <strong><span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span></strong>.</p>
                <ul>
                    <li><strong>Ki·ªÉm tra <span class="keyword" data-keyword="observable-behavior">h√†nh vi quan s√°t ƒë∆∞·ª£c</span>:</strong> Gi√∫p b√†i test c·ªßa b·∫°n tr·ªü n√™n b·ªÅn v·ªØng.</li>
                    <li><strong>Ki·ªÉm tra <span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span>:</strong> Khi·∫øn b√†i test c·ªßa b·∫°n tr·ªü n√™n mong manh (brittle).</li>
                </ul>
                <h2>ƒê·ªãnh nghƒ©a</h2>
                <p>M·ªçi ƒëo·∫°n code ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞·ª£c ph√¢n lo·∫°i theo hai g√≥c nh√¨n:</p>
                <ol>
                    <li><strong>G√≥c nh√¨n C√¥ng khai (<span class="keyword" data-keyword="public-api">Public</span> vs. <span class="keyword" data-keyword="private-api">Private</span>):</strong>
                        <ul>
                            <li><strong><span class="keyword" data-keyword="public-api">Public API</span>:</strong> C√°c ph∆∞∆°ng th·ª©c v√† thu·ªôc t√≠nh m√† code b√™n ngo√†i (client) ƒë∆∞·ª£c ph√©p truy c·∫≠p v√† s·ª≠ d·ª•ng.</li>
                            <li><strong><span class="keyword" data-keyword="private-api">Private API</span>:</strong> C√°c ph∆∞∆°ng th·ª©c v√† thu·ªôc t√≠nh c·ªßa m·ªôt class ch·ªâ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong n·ªôi b·ªô v√† kh√¥ng d√†nh cho b√™n ngo√†i truy c·∫≠p.</li>
                        </ul>
                    </li>
                    <li><strong>G√≥c nh√¨n M·ª•c ƒë√≠ch (Behavior vs. Implementation):</strong>
                        <ul>
                            <li><strong><span class="keyword" data-keyword="observable-behavior">H√†nh vi quan s√°t ƒë∆∞·ª£c (Observable Behavior)</span>:</strong> L√† nh·ªØng k·∫øt qu·∫£ ho·∫∑c t√°c d·ª•ng ph·ª• (side effect) m√† client mong ƒë·ª£i khi t∆∞∆°ng t√°c v·ªõi ƒë·ªëi t∆∞·ª£ng. ƒê√¢y l√† "c√°i g√¨" (what) m√† code c·ªßa b·∫°n l√†m.</li>
                            <li><strong><span class="keyword" data-keyword="implementation-details">Chi ti·∫øt c√†i ƒë·∫∑t (Implementation Details)</span>:</strong> L√† c√°c b∆∞·ªõc, thu·∫≠t to√°n, ho·∫∑c c·∫•u tr√∫c d·ªØ li·ªáu n·ªôi b·ªô ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ t·∫°o ra h√†nh vi ƒë√≥. ƒê√¢y l√† "l√†m th·∫ø n√†o" (how) m√† code c·ªßa b·∫°n th·ª±c hi·ªán c√¥ng vi·ªác.</li>
                        </ul>
                    </li>
                </ol>
                <h3>M·ªëi quan h·ªá</h3>
                <p>M·ªôt <span class="keyword" data-keyword="api">API</span> ƒë∆∞·ª£c thi·∫øt k·∫ø t·ªët (well-designed) l√† khi <strong><span class="keyword" data-keyword="public-api">Public API</span> v√† <span class="keyword" data-keyword="observable-behavior">Observable Behavior</span> l√† m·ªôt</strong>. T·∫•t c·∫£ c√°c <span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span> ph·∫£i ƒë∆∞·ª£c che gi·∫•u (<span class="keyword" data-keyword="encapsulation">encapsulated</span>) v√† l√† <code>private</code>.</p>
                <img src="images/api_design.svg" alt="Well-designed API vs. Leaking API">
                <p>Khi m·ªôt <span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span> b·ªã "r√≤ r·ªâ" (leak) ra <span class="keyword" data-keyword="public-api">Public API</span>, n√≥ s·∫Ω c√°m d·ªó b·∫°n vi·∫øt nh·ªØng b√†i test ki·ªÉm tra v√†o ƒë√≥, v√† ƒë√≥ l√† ngu·ªìn g·ªëc c·ªßa c√°c b√†i test mong manh.</p>

                <h2>V√≠ d·ª•: R√≤ r·ªâ Logic</h2>
                <p>H√£y xem x√©t m·ªôt class <code>User</code> c·∫ßn ƒë·∫£m b·∫£o t√™n ng∆∞·ªùi d√πng kh√¥ng d√†i qu√° 50 k√Ω t·ª±.</p>
                <h3>üî¥ C√°ch l√†m sai (R√≤ r·ªâ)</h3>
                <p>Logic chu·∫©n h√≥a t√™n (<code>normalize_name</code>) b·ªã ƒë·ªÉ ·ªü d·∫°ng <code>public</code>.</p>
<pre><code class="language-python"># BAD CODE: Logic chu·∫©n h√≥a b·ªã r√≤ r·ªâ
class User:
    def __init__(self, name=""):
        self.name = name

    # ƒê√¢y l√† chi ti·∫øt c√†i ƒë·∫∑t, nh∆∞ng l·∫°i l√† public!
    def normalize_name(self, name):
        # ... logic c·∫Øt chu·ªói ...

class UserController:
    def rename_user(self, user, new_name):
        # Client ph·∫£i bi·∫øt qu√° nhi·ªÅu v·ªÅ "l√†m th·∫ø n√†o"
        normalized = user.normalize_name(new_name)
        user.name = normalized
</code></pre>
                <p><strong>V·∫•n ƒë·ªÅ:</strong> Client ph·∫£i g·ªçi 2 ph∆∞∆°ng th·ª©c ƒë·ªÉ ho√†n th√†nh m·ªôt m·ª•c ti√™u. N·∫øu m·ªôt client kh√°c qu√™n g·ªçi <code>normalize_name</code>, h·ªá th·ªëng s·∫Ω c√≥ d·ªØ li·ªáu kh√¥ng nh·∫•t qu√°n.</p>

                <h3>üü¢ C√°ch l√†m ƒë√∫ng (ƒê√≥ng g√≥i)</h3>
                <p>Logic chu·∫©n h√≥a ƒë∆∞·ª£c gi·∫•u v√†o b√™n trong v√† tr·ªü th√†nh <code>private</code>.</p>
<pre><code class="language-python"># GOOD CODE: ƒê√≥ng g√≥i ho√†n to√†n
class User:
    def __init__(self, name=""):
        self.name = name # Setter s·∫Ω t·ª± ƒë·ªông g·ªçi logic chu·∫©n h√≥a

    @property
    def name(self):
        return self._name

    @name.setter
    def name(self, value):
        self._name = self._normalize_name(value)

    # Chi ti·∫øt c√†i ƒë·∫∑t th·ª±c s·ª±
    def _normalize_name(self, name):
        # ... logic c·∫Øt chu·ªói ...

class UserController:
    def rename_user(self, user, new_name):
        # Client ch·ªâ c·∫ßn bi·∫øt "c√°i g√¨", kh√¥ng c·∫ßn bi·∫øt "l√†m th·∫ø n√†o"
        user.name = new_name
</code></pre>
                <p><strong>L·ª£i √≠ch:</strong> B√¢y gi·ªù b·∫°n c√≥ th·ªÉ thay ƒë·ªïi ho√†n to√†n logic <code>_normalize_name</code> m√† kh√¥ng l√†m h·ªèng <code>UserController</code> ho·∫∑c c√°c b√†i test c·ªßa n√≥.</p>

                <h2>Nguy√™n l√Ω Tell, Don't Ask</h2>
                <p>Nguy√™n l√Ω n√†y l√† kim ch·ªâ nam gi√∫p b·∫°n thi·∫øt k·∫ø <span class="keyword" data-keyword="api">API</span> t·ªët:</p>
                <ul>
                    <li><strong>Ask (H·ªèi - X·∫•u):</strong> H·ªèi m·ªôt ƒë·ªëi t∆∞·ª£ng v·ªÅ tr·∫°ng th√°i c·ªßa n√≥, th·ª±c hi·ªán logic ·ªü b√™n ngo√†i, r·ªìi c·∫≠p nh·∫≠t l·∫°i tr·∫°ng th√°i cho ƒë·ªëi t∆∞·ª£ng ƒë√≥. (ƒê√¢y l√† v√≠ d·ª• sai ·ªü tr√™n).</li>
                    <li><strong>Tell (B·∫£o - T·ªët):</strong> Ra l·ªánh cho m·ªôt ƒë·ªëi t∆∞·ª£ng th·ª±c hi·ªán m·ªôt h√†nh ƒë·ªông. ƒê·ªëi t∆∞·ª£ng s·∫Ω t·ª± s·ª≠ d·ª•ng tr·∫°ng th√°i n·ªôi b·ªô c·ªßa n√≥ ƒë·ªÉ th·ª±c hi·ªán h√†nh ƒë·ªông ƒë√≥. (ƒê√¢y l√† v√≠ d·ª• ƒë√∫ng ·ªü tr√™n).</li>
                </ul>
                <p>B·∫±ng c√°ch tu√¢n th·ªß "Tell, Don't Ask", b·∫°n s·∫Ω t·ª± ƒë·ªông t·∫°o ra c√°c <span class="keyword" data-keyword="api">API</span> ƒë√≥ng g√≥i t·ªët, che gi·∫•u c√°c <span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span> v√† gi√∫p cho c√°c b√†i test c·ªßa b·∫°n tr·ªü n√™n b·ªÅn v·ªØng h∆°n.</p>
            </section>

            <section id="test-doubles" class="content-section">
                <h1>Mocks, Stubs v√† Test Doubles</h1>
                <p>Khi vi·∫øt <span class="keyword" data-keyword="unit-test">unit test</span>, ch√∫ng ta c·∫ßn "c√°ch ly" ƒë∆°n v·ªã ƒëang ƒë∆∞·ª£c test (<span class="keyword" data-keyword="sut">SUT - System Under Test</span>) kh·ªèi c√°c <span class="keyword" data-keyword="dependency">dependency</span> (ƒë·ªëi t∆∞·ª£ng ph·ª• thu·ªôc) c·ªßa n√≥. <strong><span class="keyword" data-keyword="test-double">Test Doubles</span></strong> l√† thu·∫≠t ng·ªØ chung ch·ªâ c√°c ƒë·ªëi t∆∞·ª£ng gi·∫£ ƒë∆∞·ª£c t·∫°o ra ƒë·ªÉ thay th·∫ø c√°c <span class="keyword" data-keyword="dependency">dependency</span> th·∫≠t trong m√¥i tr∆∞·ªùng test.</p>
                <p>M·∫∑c d√π ch√∫ng ta hay g·ªçi chung l√† "<span class="keyword" data-keyword="mock">mock</span>", nh∆∞ng c√≥ nhi·ªÅu lo·∫°i <span class="keyword" data-keyword="test-double">Test Double</span> kh√°c nhau, m·ªói lo·∫°i c√≥ m·ªôt m·ª•c ƒë√≠ch ri√™ng. Ph√¢n bi·ªát r√µ ch√∫ng l√† ch√¨a kh√≥a ƒë·ªÉ vi·∫øt c√°c b√†i test ƒë√∫ng ƒë·∫Øn.</p>

                <h2><span class="keyword" data-keyword="stub">Stub</span> (Gi·∫£ l·∫≠p d·ªØ li·ªáu)</h2>
                <ul>
                    <li><strong>M·ª•c ƒë√≠ch:</strong> Cung c·∫•p d·ªØ li·ªáu ƒë·∫ßu v√†o (input) cho <span class="keyword" data-keyword="sut">SUT</span> ƒë·ªÉ n√≥ c√≥ th·ªÉ ch·∫°y. <span class="keyword" data-keyword="stub">Stub</span> gi√∫p m√¥ ph·ªèng c√°c tr·∫°ng th√°i v√† gi√° tr·ªã kh√°c nhau.</li>
                    <li><strong>Vai tr√≤:</strong> ƒê√≥ng vai tr√≤ "ng∆∞·ªùi cung c·∫•p th√¥ng tin". <span class="keyword" data-keyword="sut">SUT</span> s·∫Ω <strong>l·∫•y d·ªØ li·ªáu t·ª´</strong> <span class="keyword" data-keyword="stub">Stub</span>.</li>
                    <li><strong>Quy t·∫Øc v√†ng:</strong> <strong>ƒê·ª´ng bao gi·ªù x√°c minh (verify) m·ªôt l·ªùi g·ªçi ƒë·∫øn <span class="keyword" data-keyword="stub">Stub</span>.</strong> Vi·ªác <span class="keyword" data-keyword="sut">SUT</span> g·ªçi <span class="keyword" data-keyword="stub">Stub</span> m·ªôt hay nhi·ªÅu l·∫ßn kh√¥ng quan tr·ªçng, mi·ªÖn l√† k·∫øt qu·∫£ cu·ªëi c√πng ƒë√∫ng. Vi·ªác verify <span class="keyword" data-keyword="stub">Stub</span> s·∫Ω khi·∫øn test b·ªã g·∫Øn ch·∫∑t v√†o <span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span>.</li>
                </ul>

                <div class="practice-link-box">
                    <p>üí° <strong>Xem th·ª±c h√†nh:</strong> ƒê·ªÉ xem c√°ch t·∫°o Stubs v√† Mocks trong th·ª±c t·∫ø, h√£y tham kh·∫£o c√°c v√≠ d·ª• trong ph·∫ßn <a href="#" class="nav-item" data-target="pytest-hands-on">Th·ª±c h√†nh PyTest</a> v√† <a href="#" class="nav-item" data-target="gtest-hands-on">Th·ª±c h√†nh GTest</a>.</p>
                </div>
<pre><code class="language-python">from unittest.mock import Mock

# database_stub l√† m·ªôt Stub v√¨ n√≥ cung c·∫•p d·ªØ li·ªáu cho SUT
database_stub = Mock()
database_stub.get_user.return_value = {"name": "Alice", "email": "alice@example.com"}

# SUT s·∫Ω s·ª≠ d·ª•ng d·ªØ li·ªáu n√†y ƒë·ªÉ th·ª±c hi·ªán logic
user_service = UserService(database_stub)
</code></pre>

                <h2><span class="keyword" data-keyword="mock">Mock</span> (Gi·∫£ l·∫≠p h√†nh ƒë·ªông)</h2>
                <ul>
                    <li><strong>M·ª•c ƒë√≠ch:</strong> Gi·∫£ l·∫≠p v√† x√°c minh c√°c t∆∞∆°ng t√°c ƒëi ra (outcoming interaction) t·ª´ <span class="keyword" data-keyword="sut">SUT</span> ƒë·∫øn c√°c h·ªá th·ªëng b√™n ngo√†i.</li>
                    <li><strong>Vai tr√≤:</strong> ƒê√≥ng vai tr√≤ "ng∆∞·ªùi nh·∫≠n l·ªánh". <span class="keyword" data-keyword="sut">SUT</span> s·∫Ω <strong>g·ª≠i l·ªánh ƒë·∫øn</strong> <span class="keyword" data-keyword="mock">Mock</span>.</li>
                    <li><strong>C√°ch d√πng:</strong> Sau khi h√†nh ƒë·ªông (Act) di·ªÖn ra, b·∫°n s·∫Ω x√°c minh (verify) xem <span class="keyword" data-keyword="sut">SUT</span> ƒë√£ g·ªçi ƒë√∫ng ph∆∞∆°ng th·ª©c c·ªßa <span class="keyword" data-keyword="mock">Mock</span> v·ªõi ƒë√∫ng tham s·ªë hay ch∆∞a.</li>
                </ul>
<pre><code class="language-python">from unittest.mock import Mock

# email_sender_mock l√† m·ªôt Mock v√¨ n√≥ nh·∫≠n l·ªánh t·ª´ SUT
email_sender_mock = Mock()

user_service = UserService(email_sender_mock)
user_service.register("alice@example.com")

# X√°c minh r·∫±ng SUT ƒë√£ g·ª≠i l·ªánh ƒëi ƒë√∫ng c√°ch
email_sender_mock.send_welcome_email.assert_called_with("alice@example.com")
</code></pre>

                <h2>Ph√¢n bi·ªát qua Nguy√™n l√Ω CQS (Command-Query Separation)</h2>
                <p>M·ªôt c√°ch tuy·ªát v·ªùi ƒë·ªÉ ph√¢n bi·ªát khi n√†o d√πng <span class="keyword" data-keyword="stub">Stub</span> v√† khi n√†o d√πng <span class="keyword" data-keyword="mock">Mock</span> l√† d·ª±a v√†o nguy√™n l√Ω CQS:</p>
                <ul>
                    <li><strong>Query (Truy v·∫•n):</strong> M·ªôt ph∆∞∆°ng th·ª©c tr·∫£ v·ªÅ gi√° tr·ªã nh∆∞ng kh√¥ng l√†m thay ƒë·ªïi tr·∫°ng th√°i h·ªá th·ªëng.
                        <ul><li>C√°c <span class="keyword" data-keyword="dependency">dependency</span> d·∫°ng Query n√™n ƒë∆∞·ª£c thay th·∫ø b·∫±ng <strong><span class="keyword" data-keyword="stub">Stub</span></strong>.</li></ul>
                    </li>
                    <li><strong>Command (L·ªánh):</strong> M·ªôt ph∆∞∆°ng th·ª©c l√†m thay ƒë·ªïi tr·∫°ng th√°i h·ªá th·ªëng (side effect) nh∆∞ng kh√¥ng tr·∫£ v·ªÅ gi√° tr·ªã (void).
                        <ul><li>C√°c <span class="keyword" data-keyword="dependency">dependency</span> d·∫°ng Command n√™n ƒë∆∞·ª£c thay th·∫ø b·∫±ng <strong><span class="keyword" data-keyword="mock">Mock</span></strong>.</li></ul>
                    </li>
                </ul>

                <h2>C√°c lo·∫°i <span class="keyword" data-keyword="test-double">Test Double</span> kh√°c</h2>
                <ul>
                    <li><strong>Dummy:</strong> M·ªôt ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c truy·ªÅn v√†o ch·ªâ ƒë·ªÉ l·∫•p ƒë·∫ßy danh s√°ch tham s·ªë, nh∆∞ng kh√¥ng bao gi·ªù ƒë∆∞·ª£c s·ª≠ d·ª•ng th·ª±c s·ª±.</li>
                    <li><strong>Fake:</strong> M·ªôt ƒë·ªëi t∆∞·ª£ng c√≥ m·ªôt phi√™n b·∫£n c√†i ƒë·∫∑t ho·∫°t ƒë·ªông th·ª±c s·ª±, nh∆∞ng ƒë∆°n gi·∫£n h∆°n nhi·ªÅu so v·ªõi b·∫£n production (v√≠ d·ª•: in-memory <span class="keyword" data-keyword="database">database</span> thay v√¨ m·ªôt <span class="keyword" data-keyword="database">database</span> th·∫≠t).</li>
                    <li><strong>Spy:</strong> M·ªôt ƒë·ªëi t∆∞·ª£ng v·ª´a ƒë√≥ng vai tr√≤ l√† <span class="keyword" data-keyword="stub">Stub</span> (cung c·∫•p d·ªØ li·ªáu), v·ª´a ghi l·∫°i th√¥ng tin v·ªÅ c√°c l·ªùi g·ªçi ƒë·∫øn n√≥ (gi·ªëng <span class="keyword" data-keyword="mock">Mock</span>). Spy th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ bao b·ªçc m·ªôt ƒë·ªëi t∆∞·ª£ng th·∫≠t.</li>
                </ul>
                <blockquote>
                    <p><strong>L∆∞u √Ω:</strong> C√°c th∆∞ vi·ªán nh∆∞ <code>unittest.mock</code> c·ªßa Python hay <code>Moq</code> c·ªßa C# th∆∞·ªùng cung c·∫•p m·ªôt class <code>Mock</code> ƒëa nƒÉng. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng class n√†y ƒë·ªÉ t·∫°o ra c·∫£ <span class="keyword" data-keyword="stub">Stub</span>, <span class="keyword" data-keyword="mock">Mock</span>, v√† Spy. ƒêi·ªÅu quan tr·ªçng l√† <strong>c√°ch b·∫°n s·ª≠ d·ª•ng</strong> ƒë·ªëi t∆∞·ª£ng ƒë√≥ trong b√†i test s·∫Ω quy·∫øt ƒë·ªãnh vai tr√≤ th·ª±c s·ª± c·ªßa n√≥.</p>
                </blockquote>
            </section>

            <section id="architecture-mocking" class="content-section">
                <h1>Ki·∫øn tr√∫c v√† Quy t·∫Øc Mocking</h1>
                <p>Vi·ªác quy·∫øt ƒë·ªãnh "n√™n <span class="keyword" data-keyword="mock">mock</span> c√°i g√¨" v√† "kh√¥ng n√™n <span class="keyword" data-keyword="mock">mock</span> c√°i g√¨" l√† m·ªôt trong nh·ªØng quy·∫øt ƒë·ªãnh kh√≥ khƒÉn nh·∫•t khi vi·∫øt test. M·ªôt quy t·∫Øc sai l·∫ßm c√≥ th·ªÉ d·∫´n ƒë·∫øn m·ªôt b·ªô test mong manh, kh√≥ b·∫£o tr√¨. C√¢u tr·∫£ l·ªùi n·∫±m ·ªü vi·ªác hi·ªÉu r√µ ki·∫øn tr√∫c ·ª©ng d·ª•ng c·ªßa b·∫°n.</p>

                <h2><span class="keyword" data-keyword="hexagonal-architecture">Ki·∫øn tr√∫c L·ª•c gi√°c (Hexagonal Architecture)</span></h2>
                <p>Ki·∫øn tr√∫c n√†y chia ·ª©ng d·ª•ng c·ªßa b·∫°n th√†nh hai ph·∫ßn ch√≠nh:</p>
                <ol>
                    <li><strong>L√µi ·ª©ng d·ª•ng (<span class="keyword" data-keyword="domain-layer">Domain Layer</span> & <span class="keyword" data-keyword="application-services-layer">Application Services Layer</span>):</strong> ƒê√¢y l√† n∆°i ch·ª©a to√†n b·ªô logic nghi·ªáp v·ª• c·ªßa b·∫°n. L√µi n√†y ho√†n to√†n kh√¥ng bi·∫øt g√¨ v·ªÅ th·∫ø gi·ªõi b√™n ngo√†i (nh∆∞ <span class="keyword" data-keyword="database">database</span>, <span class="keyword" data-keyword="api">API</span>, UI).</li>
                    <li><strong>C√°c Adapter:</strong> L√† c√°c c·ªïng giao ti·∫øp gi√∫p l√µi ·ª©ng d·ª•ng n√≥i chuy·ªán v·ªõi th·∫ø gi·ªõi b√™n ngo√†i. V√≠ d·ª•: m·ªôt <span class="keyword" data-keyword="api">API</span> controller l√† m·ªôt adapter nh·∫≠n request t·ª´ HTTP, m·ªôt repository l√† m·ªôt adapter n√≥i chuy·ªán v·ªõi <span class="keyword" data-keyword="database">database</span>.</li>
                </ol>
                <p>M·ª•c ti√™u c·ªßa ki·∫øn tr√∫c n√†y l√† <strong>b·∫£o v·ªá l√µi nghi·ªáp v·ª• kh·ªèi nh·ªØng thay ƒë·ªïi c·ªßa c√¥ng ngh·ªá b√™n ngo√†i</strong>.</p>

                <h2>Ph√¢n bi·ªát hai lo·∫°i Giao ti·∫øp</h2>
                <p>ƒê√¢y l√† ch√¨a kh√≥a ƒë·ªÉ ƒë∆∞a ra quy·∫øt ƒë·ªãnh <span class="keyword" data-keyword="mocking</span> ƒë√∫ng ƒë·∫Øn:</p>
                <ol>
                    <li><strong>Giao ti·∫øp n·ªôi b·ªô (Intra-system communications):</strong>
                        <ul>
                            <li><strong>L√† g√¨:</strong> S·ª± t∆∞∆°ng t√°c gi·ªØa c√°c class <strong>b√™n trong</strong> l√µi ·ª©ng d·ª•ng c·ªßa b·∫°n (v√≠ d·ª•: <code>Customer</code> g·ªçi <code>Store</code>).</li>
                            <li><strong>B·∫£n ch·∫•t:</strong> ƒê√¢y l√† <strong><span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t (Implementation Details)</span></strong>.</li>
                            <li><strong>Quy t·∫Øc:</strong> <strong>KH√îNG ƒê∆Ø·ª¢C MOCK.</strong> Vi·ªác <span class="keyword" data-keyword="mock</span> c√°c giao ti·∫øp n·ªôi b·ªô s·∫Ω khi·∫øn test c·ªßa b·∫°n b·ªã g·∫Øn ch·∫∑t v√†o thi·∫øt k·∫ø hi·ªán t·∫°i v√† s·∫Ω b·ªã h·ªèng khi b·∫°n <span class="keyword" data-keyword="refactor">refactor</span>.</li>
                        </ul>
                    </li>
                    <li><strong>Giao ti·∫øp li√™n h·ªá th·ªëng (Inter-system communications):</strong>
                        <ul>
                            <li><strong>L√† g√¨:</strong> S·ª± t∆∞∆°ng t√°c t·ª´ l√µi ·ª©ng d·ª•ng c·ªßa b·∫°n ƒëi ra m·ªôt <strong>h·ªá th·ªëng b√™n ngo√†i</strong> m√† b·∫°n kh√¥ng ki·ªÉm so√°t (v√≠ d·ª•: g·ª≠i email qua SMTP server, g·ªçi <span class="keyword" data-keyword="api">API</span> thanh to√°n c·ªßa b√™n th·ª© ba).</li>
                            <li><strong>B·∫£n ch·∫•t:</strong> ƒê√¢y l√† <strong><span class="keyword" data-keyword="observable-behavior">h√†nh vi quan s√°t ƒë∆∞·ª£c (Observable Behavior)</span></strong>.</li>
                            <li><strong>Quy t·∫Øc:</strong> <strong>N√äN D√ôNG MOCK.</strong> <span class="keyword" data-keyword="mocking</span> ·ªü ƒë√¢y gi√∫p b·∫°n x√°c minh r·∫±ng ·ª©ng d·ª•ng c·ªßa b·∫°n ƒë√£ tu√¢n th·ªß ƒë√∫ng "h·ª£p ƒë·ªìng" (contract) khi giao ti·∫øp v·ªõi th·∫ø gi·ªõi b√™n ngo√†i.</li>
                        </ul>
                    </li>
                </ol>

                <h3>S∆° ƒë·ªì Quy t·∫Øc Mocking</h3>
                <img src="images/hexagonal_mocking.svg" alt="Hexagonal Architecture Mocking Rule">

                <h2>C√∫ l·ª´a v·ªÅ <span class="keyword" data-keyword="database">Database</span></h2>
                <p>M·ªôt sai l·∫ßm ph·ªï bi·∫øn l√† coi <strong><span class="keyword" data-keyword="database">database</span> c·ªßa ch√≠nh ·ª©ng d·ª•ng</strong> l√† m·ªôt h·ªá th·ªëng b√™n ngo√†i v√† lu√¥n lu√¥n <span class="keyword" data-keyword="mock">mock</span> n√≥.</p>
                <ul>
                    <li><strong><span class="keyword" data-keyword="database">Database</span> c·ªßa ·ª©ng d·ª•ng:</strong> L√† <span class="keyword" data-keyword="database">database</span> m√† ch·ªâ c√≥ ·ª©ng d·ª•ng c·ªßa b·∫°n s·ª≠ d·ª•ng v√† b·∫°n c√≥ to√†n quy·ªÅn ki·ªÉm so√°t (ƒë·ªïi schema, x√≥a b·∫£ng...). N√≥ n√™n ƒë∆∞·ª£c coi l√† m·ªôt <strong><span class="keyword" data-keyword="implementation-details">chi ti·∫øt c√†i ƒë·∫∑t</span></strong> c·ªßa ·ª©ng d·ª•ng. Vi·ªác <span class="keyword" data-keyword="mock">mock</span> n√≥ s·∫Ω l√†m gi·∫£m gi√° tr·ªã c·ªßa b√†i test.</li>
                    <li><strong>H·ªá th·ªëng b√™n ngo√†i:</strong> L√† nh·ªØng h·ªá th·ªëng b·∫°n kh√¥ng ki·ªÉm so√°t, nh∆∞ m·ªôt <span class="keyword" data-keyword="api">API</span> c·ªßa ƒë·ªëi t√°c.</li>
                </ul>
                <blockquote>
                    <p><strong>L·ªùi khuy√™n:</strong> Thay v√¨ <span class="keyword" data-keyword="mock">mock</span> <span class="keyword" data-keyword="database">database</span>, h√£y vi·∫øt c√°c b√†i <strong><span class="keyword" data-keyword="integration-test">Integration Test</span></strong> ch·∫°y tr√™n m·ªôt <span class="keyword" data-keyword="database">database</span> th·∫≠t (ho·∫∑c m·ªôt phi√™n b·∫£n trong Docker). ƒêi·ªÅu n√†y s·∫Ω mang l·∫°i s·ª± t·ª± tin cao h∆°n nhi·ªÅu. C√°c b√†i <strong><span class="keyword" data-keyword="unit-test">Unit Test</span></strong> n√™n t·∫≠p trung v√†o c√°c logic nghi·ªáp v·ª• thu·∫ßn t√∫y kh√¥ng ph·ª• thu·ªôc v√†o I/O.</p>
                </blockquote>
            </section>

            <section id="glossary" class="content-section">
                <h1>T·ª´ ƒëi·ªÉn thu·∫≠t ng·ªØ</h1>
                <p>ƒê√¢y l√† n∆°i t·ªïng h·ª£p ƒë·ªãnh nghƒ©a chi ti·∫øt cho c√°c thu·∫≠t ng·ªØ quan tr·ªçng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong wiki n√†y.</p>
                <!-- ƒê·ªãnh nghƒ©a chi ti·∫øt s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
            </section>

            <section id="pytest-hands-on" class="content-section">
                <h1>Th·ª±c h√†nh v·ªõi PyTest</h1>
                <p>PyTest l√† m·ªôt testing framework m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn trong h·ªá sinh th√°i Python. N√≥ n·ªïi ti·∫øng v·ªõi c√∫ ph√°p ƒë∆°n gi·∫£n, d·ªÖ ƒë·ªçc v√† kh·∫£ nƒÉng m·ªü r·ªông tuy·ªát v·ªùi.</p>

                <h2>1. C·∫•u tr√∫c Test c∆° b·∫£n & M·∫´u AAA</h2>
                <p>PyTest t·ª± ƒë·ªông ph√°t hi·ªán c√°c file test (c√≥ t√™n `test_*.py` ho·∫∑c `*_test.py`) v√† c√°c h√†m test (c√≥ t√™n `test_*`). H√£y xem c√°ch √°p d·ª•ng m·∫´u <span class="keyword" data-keyword="aaa">AAA</span> v·ªõi PyTest.</p>

                <h3>V√≠ d·ª•: M·ªôt h√†m t√≠nh t·ªïng ƒë∆°n gi·∫£n</h3>
                <p>Gi·∫£ s·ª≠ ch√∫ng ta c√≥ m·ªôt h√†m `add` trong file `calculator.py`:</p>
<pre><code class="language-python"># calculator.py
def add(a, b):
    return a + b
</code></pre>

                <p>B√¢y gi·ªù, ch√∫ng ta s·∫Ω vi·∫øt m·ªôt b√†i test cho h√†m n√†y trong file `test_calculator.py`:</p>
<pre><code class="language-python"># test_calculator.py
from calculator import add

def test_add_positive_numbers():
    # 1. Arrange (S·∫Øp ƒë·∫∑t)
    num1 = 5
    num2 = 10

    # 2. Act (H√†nh ƒë·ªông)
    result = add(num1, num2)

    # 3. Assert (X√°c minh)
    assert result == 15
</code></pre>
                <p>Ch·ªâ c·∫ßn ch·∫°y l·ªánh `pytest` trong terminal, PyTest s·∫Ω t·ª± ƒë·ªông t√¨m v√† ch·∫°y b√†i test n√†y.</p>

                <div class="question-box">
                    <p><strong>C√¢u h·ªèi c·ªßng c·ªë:</strong> D·ª±a v√†o v√≠ d·ª• tr√™n, h√£y vi·∫øt m·ªôt b√†i test kh√°c c√≥ t√™n l√† `test_add_negative_numbers` ƒë·ªÉ ki·ªÉm tra tr∆∞·ªùng h·ª£p c·ªông hai s·ªë √¢m (-2 v√† -3).</p>
                    <button class="btn show-answer-btn">Xem ƒë√°p √°n</button>
                    <div class="answer-content" style="display: none;">
<pre><code class="language-python"># test_calculator.py
from calculator import add

# ... (b√†i test c≈©) ...

def test_add_negative_numbers():
    # Arrange
    num1 = -2
    num2 = -3

    # Act
    result = add(num1, num2)

    # Assert
    assert result == -5
</code></pre>
                    </div>
                </div>

                <h2>2. Assertions (X√°c minh)</h2>
                <p>PyTest s·ª≠ d·ª•ng c√¢u l·ªánh `assert` ti√™u chu·∫©n c·ªßa Python, gi√∫p cho c√°c b√†i test tr·ªü n√™n r·∫•t t·ª± nhi√™n v√† d·ªÖ ƒë·ªçc. PyTest s·∫Ω cung c·∫•p th√¥ng tin chi ti·∫øt khi m·ªôt `assert` th·∫•t b·∫°i.</p>

                <h3>C√°c lo·∫°i Assertions ph·ªï bi·∫øn</h3>
                <ul>
                    <li>`assert a == b` (So s√°nh b·∫±ng)</li>
                    <li>`assert a != b` (So s√°nh kh√°c)</li>
                    <li>`assert a < b` ho·∫∑c `assert a > b` (So s√°nh l·ªõn/nh·ªè h∆°n)</li>
                    <li>`assert item in collection` (Ki·ªÉm tra s·ª± t·ªìn t·∫°i trong list/tuple/dict)</li>
                    <li>`assert isinstance(obj, MyClass)` (Ki·ªÉm tra ki·ªÉu c·ªßa ƒë·ªëi t∆∞·ª£ng)</li>
                </ul>

                <h3>V√≠ d·ª•: Ki·ªÉm tra m·ªôt ngo·∫°i l·ªá (Exception)</h3>
                <p>N·∫øu h√†m c·ªßa b·∫°n c·∫ßn ph·∫£i n√©m ra m·ªôt ngo·∫°i l·ªá trong m·ªôt tr∆∞·ªùng h·ª£p n√†o ƒë√≥, b·∫°n c√≥ th·ªÉ d√πng `pytest.raises`:</p>
<pre><code class="language-python"># calculator.py
def divide(a, b):
    if b == 0:
        raise ValueError("Cannot divide by zero")
    return a / b

# test_calculator.py
import pytest
from calculator import divide

def test_divide_by_zero_raises_exception():
    # Arrange
    num1 = 10
    num2 = 0

    # Act & Assert
    with pytest.raises(ValueError) as exc_info:
        divide(num1, num2)

    # (Optional) Ki·ªÉm tra n·ªôi dung c·ªßa exception
    assert "Cannot divide by zero" in str(exc_info.value)
</code></pre>

                <h2>3. Test Doubles (Mocks & Stubs) v·ªõi `pytest-mock`</h2>
                <p>ƒê·ªÉ s·ª≠ d·ª•ng Mocks v√† Stubs trong PyTest, th∆∞ vi·ªán `pytest-mock` l√† l·ª±a ch·ªçn ph·ªï bi·∫øn nh·∫•t. N√≥ cung c·∫•p m·ªôt fixture t√™n l√† `mocker` ƒë·ªÉ d·ªÖ d√†ng t·∫°o c√°c ƒë·ªëi t∆∞·ª£ng gi·∫£.</p>
                <p>ƒê·∫ßu ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t n√≥: `pip install pytest-mock`</p>

                <h3>V√≠ d·ª•: Gi·∫£ l·∫≠p m·ªôt API call (Stub)</h3>
                <p>H√£y t∆∞·ªüng t∆∞·ª£ng ch√∫ng ta c√≥ m·ªôt h√†m l·∫•y t·ªâ gi√° Bitcoin t·ª´ m·ªôt API b√™n ngo√†i.</p>
<pre><code class="language-python"># currency_service.py
import requests

def get_bitcoin_price_in_usd():
    try:
        response = requests.get("https://api.coindesk.com/v1/bpi/currentprice/USD.json")
        response.raise_for_status() # N√©m l·ªói n·∫øu request th·∫•t b·∫°i
        data = response.json()
        return data["bpi"]["USD"]["rate_float"]
    except requests.RequestException:
        return None
</code></pre>
                <p>Vi·ªác g·ªçi API th·∫≠t trong unit test s·∫Ω l√†m test ch·∫≠m v√† kh√¥ng ·ªïn ƒë·ªãnh. Ch√∫ng ta s·∫Ω d√πng `mocker` ƒë·ªÉ gi·∫£ l·∫≠p (stub) l·ªùi g·ªçi `requests.get`.</p>
<pre><code class="language-python"># test_currency_service.py
from currency_service import get_bitcoin_price_in_usd

def test_get_bitcoin_price_success(mocker):
    # Arrange
    # T·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng mock response
    mock_response = mocker.Mock()
    mock_response.json.return_value = {
        "bpi": {
            "USD": {
                "rate_float": 50000.0
            }
        }
    }
    mock_response.raise_for_status.return_value = None # Kh√¥ng l√†m g√¨ khi g·ªçi

    # Gi·∫£ l·∫≠p 'requests.get' v√† b·∫£o n√≥ tr·∫£ v·ªÅ mock_response
    mocker.patch("requests.get", return_value=mock_response)

    # Act
    price = get_bitcoin_price_in_usd()

    # Assert
    assert price == 50000.0
</code></pre>

                <h3>V√≠ d·ª•: X√°c minh m·ªôt h√†nh ƒë·ªông (Mock)</h3>
                <p>Gi·∫£ s·ª≠ sau khi ƒëƒÉng k√Ω ng∆∞·ªùi d√πng, h·ªá th·ªëng c·∫ßn ph·∫£i g·ª≠i m·ªôt email ch√†o m·ª´ng.</p>
<pre><code class="language-python"># user_service.py
from email_sender import send_welcome_email

class UserService:
    def __init__(self, db_connection):
        self.db = db_connection

    def register_user(self, email, password):
        # ... logic l∆∞u user v√†o database ...
        user = {"email": email}
        self.db.save(user)

        # G·ª≠i email sau khi l∆∞u th√†nh c√¥ng
        send_welcome_email(email)
        return user
</code></pre>
                <p>Ch√∫ng ta kh√¥ng mu·ªën g·ª≠i email th·∫≠t. Ch√∫ng ta ch·ªâ mu·ªën x√°c minh r·∫±ng h√†m `send_welcome_email` ƒë√£ ƒë∆∞·ª£c g·ªçi ƒë√∫ng.</p>
<pre><code class="language-python"># test_user_service.py
from user_service import UserService

def test_register_user_sends_welcome_email(mocker):
    # Arrange
    # Gi·∫£ l·∫≠p h√†m send_welcome_email
    mock_send_email = mocker.patch("user_service.send_welcome_email")

    # T·∫°o m·ªôt DB connection gi·∫£
    mock_db = mocker.Mock()

    service = UserService(db_connection=mock_db)

    # Act
    service.register_user("test@example.com", "password123")

    # Assert
    # X√°c minh r·∫±ng mock_send_email ƒë√£ ƒë∆∞·ª£c g·ªçi ƒë√∫ng m·ªôt l·∫ßn v·ªõi ƒë√∫ng tham s·ªë
    mock_send_email.assert_called_once_with("test@example.com")

    # C≈©ng c√≥ th·ªÉ x√°c minh r·∫±ng user ƒë√£ ƒë∆∞·ª£c l∆∞u
    mock_db.save.assert_called_once()
</code></pre>

                <div class="question-box">
                    <p><strong>C√¢u h·ªèi c·ªßng c·ªë:</strong> Trong v√≠ d·ª• v·ªÅ `test_get_bitcoin_price_success`, ch√∫ng ta ƒë√£ stub tr∆∞·ªùng h·ª£p th√†nh c√¥ng. H√£y vi·∫øt m·ªôt b√†i test m·ªõi t√™n l√† `test_get_bitcoin_price_failure` ƒë·ªÉ ki·ªÉm tra tr∆∞·ªùng h·ª£p `requests.get` n√©m ra m·ªôt l·ªói `RequestException`.</p>
                    <button class="btn show-answer-btn">Xem ƒë√°p √°n</button>
                    <div class="answer-content" style="display: none;">
<pre><code class="language-python"># test_currency_service.py
import requests
from currency_service import get_bitcoin_price_in_usd

# ... (b√†i test c≈©) ...

def test_get_bitcoin_price_failure(mocker):
    # Arrange
    # Gi·∫£ l·∫≠p 'requests.get' ƒë·ªÉ n√≥ n√©m ra m·ªôt l·ªói khi ƒë∆∞·ª£c g·ªçi
    mocker.patch("requests.get", side_effect=requests.RequestException("API is down"))

    # Act
    price = get_bitcoin_price_in_usd()

    # Assert
    # Mong ƒë·ª£i k·∫øt qu·∫£ l√† None khi c√≥ l·ªói x·∫£y ra
    assert price is None
</code></pre>
                    </div>
                </div>

            </section>

            <section id="gtest-hands-on" class="content-section">
                <h1>Th·ª±c h√†nh v·ªõi GoogleTest (GTest)</h1>
                <p>GoogleTest (th∆∞·ªùng g·ªçi l√† GTest) l√† m·ªôt framework unit testing h√†ng ƒë·∫ßu cho C++. N√≥ cung c·∫•p m·ªôt b·ªô assertions phong ph√∫, c∆° ch·∫ø test fixtures m·∫°nh m·∫Ω, v√† ƒë∆∞·ª£c t√≠ch h·ª£p ch·∫∑t ch·∫Ω v·ªõi GoogleMock (GMock) ƒë·ªÉ t·∫°o c√°c ƒë·ªëi t∆∞·ª£ng gi·∫£.</p>
                <p><em>L∆∞u √Ω: C√°c v√≠ d·ª• d∆∞·ªõi ƒë√¢y gi·∫£ ƒë·ªãnh b·∫°n ƒë√£ thi·∫øt l·∫≠p GTest v√† GMock trong m√¥i tr∆∞·ªùng build c·ªßa m√¨nh (v√≠ d·ª•: qua CMake).</em></p>

                <h2>1. C·∫•u tr√∫c Test c∆° b·∫£n & M·∫´u AAA</h2>
                <p>Trong GTest, c√°c b√†i test ƒë∆∞·ª£c nh√≥m l·∫°i trong c√°c "Test Case" (ho·∫∑c "Test Suite") b·∫±ng macro `TEST()`. Macro n√†y nh·∫≠n hai tham s·ªë: t√™n c·ªßa Test Case v√† t√™n c·ªßa b√†i test c·ª• th·ªÉ.</p>

                <h3>V√≠ d·ª•: M·ªôt h√†m t√≠nh t·ªïng ƒë∆°n gi·∫£n</h3>
                <p>Gi·∫£ s·ª≠ ch√∫ng ta c√≥ m·ªôt h√†m `add` trong file `calculator.h`:</p>
<pre><code class="language-cpp">// calculator.h
#ifndef CALCULATOR_H
#define CALCULATOR_H

int add(int a, int b);

#endif // CALCULATOR_H

// calculator.cpp
#include "calculator.h"

int add(int a, int b) {
    return a + b;
}
</code></pre>

                <p>File test (`test_calculator.cpp`) s·∫Ω tr√¥ng nh∆∞ sau:</p>
<pre><code class="language-cpp">// test_calculator.cpp
#include &lt;gtest/gtest.h&gt;
#include "calculator.h" // Include file ch·ª©a code c·∫ßn test

// C√∫ ph√°p: TEST(TestCaseName, TestName)
TEST(CalculatorTest, AddPositiveNumbers) {
    // 1. Arrange (S·∫Øp ƒë·∫∑t)
    int num1 = 5;
    int num2 = 10;

    // 2. Act (H√†nh ƒë·ªông)
    int result = add(num1, num2);

    // 3. Assert (X√°c minh)
    ASSERT_EQ(result, 15);
}
</code></pre>

                <div class="question-box">
                    <p><strong>C√¢u h·ªèi c·ªßng c·ªë:</strong> D·ª±a v√†o v√≠ d·ª• tr√™n, h√£y vi·∫øt m·ªôt b√†i test kh√°c c√≥ t√™n l√† `AddNegativeNumbers` trong c√πng Test Case `CalculatorTest` ƒë·ªÉ ki·ªÉm tra tr∆∞·ªùng h·ª£p c·ªông hai s·ªë √¢m (-5 v√† -10).</p>
                    <button class="btn show-answer-btn">Xem ƒë√°p √°n</button>
                    <div class="answer-content" style="display: none;">
<pre><code class="language-cpp">// test_calculator.cpp
#include &lt;gtest/gtest.h&gt;
#include "calculator.h"

// ... (b√†i test c≈©) ...

TEST(CalculatorTest, AddNegativeNumbers) {
    // Arrange
    int num1 = -5;
    int num2 = -10;

    // Act
    int result = add(num1, num2);

    // Assert
    ASSERT_EQ(result, -15);
}
</code></pre>
                    </div>
                </div>

                <h2>2. Assertions (X√°c minh)</h2>
                <p>GTest cung c·∫•p m·ªôt b·ªô macro assertion ƒëa d·∫°ng, ƒë∆∞·ª£c chia th√†nh hai lo·∫°i:</p>
                <ul>
                    <li>`ASSERT_*`: Khi m·ªôt assertion n√†y th·∫•t b·∫°i, n√≥ s·∫Ω <strong>ch·∫•m d·ª©t b√†i test ngay l·∫≠p t·ª©c</strong>.</li>
                    <li>`EXPECT_*`: Khi m·ªôt assertion n√†y th·∫•t b·∫°i, n√≥ s·∫Ω ghi nh·∫≠n l·ªói nh∆∞ng <strong>v·∫´n ti·∫øp t·ª•c ch·∫°y c√°c ph·∫ßn c√≤n l·∫°i</strong> c·ªßa b√†i test. H·∫ßu h·∫øt c√°c tr∆∞·ªùng h·ª£p b·∫°n n√™n d√πng `EXPECT_*`.</li>
                </ul>

                <h3>C√°c Assertions ph·ªï bi·∫øn</h3>
                <ul>
                    <li>`EXPECT_EQ(val1, val2);` (B·∫±ng nhau)</li>
                    <li>`EXPECT_NE(val1, val2);` (Kh√¥ng b·∫±ng nhau)</li>
                    <li>`EXPECT_LT(val1, val2);` (Nh·ªè h∆°n)</li>
                    <li>`EXPECT_GT(val1, val2);` (L·ªõn h∆°n)</li>
                    <li>`EXPECT_TRUE(condition);` (ƒêi·ªÅu ki·ªán l√† ƒë√∫ng)</li>
                    <li>`EXPECT_FALSE(condition);` (ƒêi·ªÅu ki·ªán l√† sai)</li>
                    <li>`EXPECT_THROW(statement, exception_type);` (N√©m ra ngo·∫°i l·ªá)</li>
                </ul>

                <h3>V√≠ d·ª•: Ki·ªÉm tra ngo·∫°i l·ªá</h3>
<pre><code class="language-cpp">// calculator.h
#include &lt;stdexcept&gt;
// ...
double divide(double a, double b) {
    if (b == 0) {
        throw std::invalid_argument("Cannot divide by zero");
    }
    return a / b;
}

// test_calculator.cpp
TEST(CalculatorTest, DivideByZeroThrowsException) {
    // Arrange
    double num1 = 10.0;
    double num2 = 0.0;

    // Act & Assert
    EXPECT_THROW(divide(num1, num2), std::invalid_argument);
}
</code></pre>

                <h2>3. Test Doubles v·ªõi GoogleMock (GMock)</h2>
                <p>GMock ƒë∆∞·ª£c d√πng ƒë·ªÉ t·∫°o c√°c ƒë·ªëi t∆∞·ª£ng gi·∫£ (mocks) trong C++. ƒêi·ªÅu n√†y ƒë·∫∑c bi·ªát h·ªØu √≠ch khi b·∫°n c·∫ßn gi·∫£ l·∫≠p m·ªôt dependency l√† m·ªôt interface (m·ªôt class tr·ª´u t∆∞·ª£ng v·ªõi c√°c h√†m virtual thu·∫ßn t√∫y).</p>

                <h3>V√≠ d·ª•: Gi·∫£ l·∫≠p m·ªôt Database (Stub & Mock)</h3>
                <p>Gi·∫£ s·ª≠ ch√∫ng ta c√≥ m·ªôt interface `Database` v√† m·ªôt class `UserService` s·ª≠ d·ª•ng n√≥.</p>
<pre><code class="language-cpp">// database.h
class Database {
public:
    virtual ~Database() = default;
    virtual bool userExists(const std::string& email) = 0;
    virtual void saveUser(const std::string& email) = 0;
};

// user_service.h
#include "database.h"
class UserService {
public:
    explicit UserService(Database* db) : database(db) {}

    bool registerUser(const std::string& email) {
        if (database-&gt;userExists(email)) {
            return false; // User ƒë√£ t·ªìn t·∫°i
        }
        database-&gt;saveUser(email);
        return true;
    }
private:
    Database* database;
};
</code></pre>

                <p>ƒê·ªÉ test `UserService`, ch√∫ng ta s·∫Ω t·∫°o m·ªôt `MockDatabase` b·∫±ng GMock.</p>
<pre><code class="language-cpp">// test_user_service.cpp
#include &lt;gtest/gtest.h&gt;
#include &lt;gmock/gmock.h&gt;
#include "user_service.h"
#include "database.h"

// 1. T·∫°o class Mock t·ª´ interface
class MockDatabase : public Database {
public:
    // MOCK_METHOD(return_type, method_name, (arg_types), (qualifiers));
    MOCK_METHOD(bool, userExists, (const std::string& email), (override));
    MOCK_METHOD(void, saveUser, (const std::string& email), (override));
};

TEST(UserServiceTest, RegisterNewUserSuccessfully) {
    // Arrange
    MockDatabase mockDb;
    UserService service(&amp;mockDb);
    std::string newUserEmail = "new_user@test.com";

    // Thi·∫øt l·∫≠p h√†nh vi cho Mock (ƒë√≥ng vai tr√≤ Stub)
    // Khi userExists ƒë∆∞·ª£c g·ªçi v·ªõi email n√†y, h√£y tr·∫£ v·ªÅ false
    EXPECT_CALL(mockDb, userExists(newUserEmail))
        .WillOnce(testing::Return(false));

    // Thi·∫øt l·∫≠p k·ª≥ v·ªçng (ƒë√≥ng vai tr√≤ Mock)
    // K·ª≥ v·ªçng r·∫±ng saveUser s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë√∫ng m·ªôt l·∫ßn v·ªõi email n√†y
    EXPECT_CALL(mockDb, saveUser(newUserEmail))
        .Times(1);

    // Act
    bool result = service.registerUser(newUserEmail);

    // Assert
    ASSERT_TRUE(result);
}
</code></pre>

                <div class="question-box">
                    <p><strong>C√¢u h·ªèi c·ªßng c·ªë:</strong> H√£y vi·∫øt m·ªôt b√†i test m·ªõi t√™n l√† `RegisterExistingUserFails` ƒë·ªÉ ki·ªÉm tra tr∆∞·ªùng h·ª£p ng∆∞·ªùi d√πng ƒë√£ t·ªìn t·∫°i. Trong tr∆∞·ªùng h·ª£p n√†y, h√†m `saveUser` kh√¥ng bao gi·ªù ƒë∆∞·ª£c ph√©p g·ªçi t·ªõi.</p>
                    <button class="btn show-answer-btn">Xem ƒë√°p √°n</button>
                    <div class="answer-content" style="display: none;">
<pre><code class="language-cpp">TEST(UserServiceTest, RegisterExistingUserFails) {
    // Arrange
    MockDatabase mockDb;
    UserService service(&amp;mockDb);
    std::string existingUserEmail = "exists@test.com";

    // Thi·∫øt l·∫≠p h√†nh vi (Stub)
    // Khi userExists ƒë∆∞·ª£c g·ªçi, h√£y tr·∫£ v·ªÅ true
    EXPECT_CALL(mockDb, userExists(existingUserEmail))
        .WillOnce(testing::Return(true));

    // Thi·∫øt l·∫≠p k·ª≥ v·ªçng (Mock)
    // K·ª≥ v·ªçng r·∫±ng saveUser s·∫Ω kh√¥ng bao gi·ªù ƒë∆∞·ª£c g·ªçi
    EXPECT_CALL(mockDb, saveUser(testing::_))
        .Times(0);

    // Act
    bool result = service.registerUser(existingUserEmail);

    // Assert
    ASSERT_FALSE(result);
}
</code></pre>
                        <p>L∆∞u √Ω: `testing::_` l√† m·ªôt "matcher" trong GMock, c√≥ nghƒ©a l√† "b·∫•t k·ª≥ gi√° tr·ªã n√†o".</p>
                    </div>
                </div>

            </section>
        </main>
    </div>

    <div id="answer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <button id="modal-close-btn" class="modal-close-btn">&times;</button>
            <div id="modal-answer-content">
                <!-- Answer content will be injected here by JS -->
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
